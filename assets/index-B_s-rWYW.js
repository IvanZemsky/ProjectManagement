import{m as J,n as K,o as A,w as B,r as m,y as X,a1 as Re,a2 as Ae,A as Te,j as s,D as V,E as Y,a3 as Pe,a4 as Ie,a5 as ae,U as ke,a6 as Me,Q as ie,q as ze,S as q,T as k,l as se,L as Be,s as he,R as fe,W as $e,p as F,t as oe,a7 as Ne,f as de,a8 as le,b as ce,e as pe,d as ge,i as We,M as je,k as Le,u as Ue,P as Fe,B as Ge}from"./index-BKcszQKM.js";import{A as Ve,T as qe,E as He,D as Oe}from"./DeleteTaskBtn-C0QW91MG.js";import{C as Qe,u as Je,T as Ke,D as Xe,a as Ye}from"./TaskColumn-B2kAtuII.js";import{o as ne,E as Ze,u as _e,D as et,B as tt}from"./Delete-DroR5Y-1.js";import{t as st}from"./constants-DWoOd6FE.js";import{u as ot,C as nt,F as rt}from"./index.esm-C2g7lyzA.js";import{T as O,I as at}from"./TextField-BVlZHFqG.js";import{S as it}from"./Select-Ds_JSibu.js";import{M as ue}from"./MenuItem-D_-LpAxY.js";import"./utils-ishblJic.js";function dt(e){return K("MuiCollapse",e)}J("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const lt=e=>{const{orientation:t,classes:o}=e,n={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return Y(n,dt,o)},ct=A("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.state==="entered"&&t.entered,o.state==="exited"&&!o.in&&o.collapsedSize==="0px"&&t.hidden]}})(B(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:t})=>t.state==="exited"&&!t.in&&t.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),pt=A("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),ut=A("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),te=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiCollapse"}),{addEndListener:r,children:d,className:i,collapsedSize:c="0px",component:l,easing:p,in:h,onEnter:f,onEntered:C,onEntering:w,onExit:g,onExited:j,onExiting:S,orientation:u="vertical",style:D,timeout:b=Pe.standard,TransitionComponent:T=Ie,...P}=n,y={...n,orientation:u,collapsedSize:c},x=lt(y),I=Re(),Z=Ae(),E=m.useRef(null),$=m.useRef(),N=typeof c=="number"?`${c}px`:c,M=u==="horizontal",z=M?"width":"height",W=m.useRef(null),_=Te(o,W),L=a=>v=>{if(a){const R=W.current;v===void 0?a(R):a(R,v)}},ee=()=>E.current?E.current[M?"clientWidth":"clientHeight"]:0,ye=L((a,v)=>{E.current&&M&&(E.current.style.position="absolute"),a.style[z]=N,f&&f(a,v)}),ve=L((a,v)=>{const R=ee();E.current&&M&&(E.current.style.position="");const{duration:G,easing:H}=ae({style:D,timeout:b,easing:p},{mode:"enter"});if(b==="auto"){const re=I.transitions.getAutoHeightDuration(R);a.style.transitionDuration=`${re}ms`,$.current=re}else a.style.transitionDuration=typeof G=="string"?G:`${G}ms`;a.style[z]=`${R}px`,a.style.transitionTimingFunction=H,w&&w(a,v)}),Ce=L((a,v)=>{a.style[z]="auto",C&&C(a,v)}),we=L(a=>{a.style[z]=`${ee()}px`,g&&g(a)}),Se=L(j),De=L(a=>{const v=ee(),{duration:R,easing:G}=ae({style:D,timeout:b,easing:p},{mode:"exit"});if(b==="auto"){const H=I.transitions.getAutoHeightDuration(v);a.style.transitionDuration=`${H}ms`,$.current=H}else a.style.transitionDuration=typeof R=="string"?R:`${R}ms`;a.style[z]=N,a.style.transitionTimingFunction=G,S&&S(a)}),Ee=a=>{b==="auto"&&Z.start($.current||0,a),r&&r(W.current,a)};return s.jsx(T,{in:h,onEnter:ye,onEntered:Ce,onEntering:ve,onExit:we,onExited:Se,onExiting:De,addEndListener:Ee,nodeRef:W,timeout:b==="auto"?null:b,...P,children:(a,v)=>s.jsx(ct,{as:l,className:V(x.root,i,{entered:x.entered,exited:!h&&N==="0px"&&x.hidden}[a]),style:{[M?"minWidth":"minHeight"]:N,...D},ref:_,...v,ownerState:{...y,state:a},children:s.jsx(pt,{ownerState:{...y,state:a},className:x.wrapper,ref:E,children:s.jsx(ut,{ownerState:{...y,state:a},className:x.wrapperInner,children:d})})})})});te&&(te.muiSupportAuto=!0);const be=m.createContext({});function mt(e){return K("MuiAccordion",e)}const Q=J("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),xt=e=>{const{classes:t,square:o,expanded:n,disabled:r,disableGutters:d}=e;return Y({root:["root",!o&&"rounded",n&&"expanded",r&&"disabled",!d&&"gutters"],heading:["heading"],region:["region"]},mt,t)},ht=A(ke,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${Q.region}`]:t.region},t.root,!o.square&&t.rounded,!o.disableGutters&&t.gutters]}})(B(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${Q.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${Q.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}}),B(({theme:e})=>({variants:[{props:t=>!t.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:t=>!t.disableGutters,style:{[`&.${Q.expanded}`]:{margin:"16px 0"}}}]}))),ft=A("h3",{name:"MuiAccordion",slot:"Heading",overridesResolver:(e,t)=>t.heading})({all:"unset"}),gt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordion"}),{children:r,className:d,defaultExpanded:i=!1,disabled:c=!1,disableGutters:l=!1,expanded:p,onChange:h,square:f=!1,slots:C={},slotProps:w={},TransitionComponent:g,TransitionProps:j,...S}=n,[u,D]=Me({controlled:p,default:i,name:"Accordion",state:"expanded"}),b=m.useCallback(_=>{D(!u),h&&h(_,!u)},[u,h,D]),[T,...P]=m.Children.toArray(r),y=m.useMemo(()=>({expanded:u,disabled:c,disableGutters:l,toggle:b}),[u,c,l,b]),x={...n,square:f,disabled:c,disableGutters:l,expanded:u},I=xt(x),Z={transition:g,...C},E={transition:j,...w},$={slots:Z,slotProps:E},[N,M]=ie("heading",{elementType:ft,externalForwardedProps:$,className:I.heading,ownerState:x}),[z,W]=ie("transition",{elementType:te,externalForwardedProps:$,ownerState:x});return s.jsxs(ht,{className:V(I.root,d),ref:o,ownerState:x,square:f,...S,children:[s.jsx(N,{...M,children:s.jsx(be.Provider,{value:y,children:T})}),s.jsx(z,{in:u,timeout:"auto",...W,children:s.jsx("div",{"aria-labelledby":T.props.id,id:T.props["aria-controls"],role:"region",className:I.region,children:P})})]})});function jt(e){return K("MuiAccordionDetails",e)}J("MuiAccordionDetails",["root"]);const bt=e=>{const{classes:t}=e;return Y({root:["root"]},jt,t)},yt=A("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(B(({theme:e})=>({padding:e.spacing(1,2,2)}))),vt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordionDetails"}),{className:r,...d}=n,i=n,c=bt(i);return s.jsx(yt,{className:V(c.root,r),ref:o,ownerState:i,...d})});function Ct(e){return K("MuiAccordionSummary",e)}const U=J("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),wt=e=>{const{classes:t,expanded:o,disabled:n,disableGutters:r}=e;return Y({root:["root",o&&"expanded",n&&"disabled",!r&&"gutters"],focusVisible:["focusVisible"],content:["content",o&&"expanded",!r&&"contentGutters"],expandIconWrapper:["expandIconWrapper",o&&"expanded"]},Ct,t)},St=A(ze,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(B(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],t),[`&.${U.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${U.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${U.disabled})`]:{cursor:"pointer"},variants:[{props:o=>!o.disableGutters,style:{[`&.${U.expanded}`]:{minHeight:64}}}]}})),Dt=A("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(B(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:t=>!t.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${U.expanded}`]:{margin:"20px 0"}}}]}))),Et=A("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(B(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${U.expanded}`]:{transform:"rotate(180deg)"}}))),Rt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordionSummary"}),{children:r,className:d,expandIcon:i,focusVisibleClassName:c,onClick:l,...p}=n,{disabled:h=!1,disableGutters:f,expanded:C,toggle:w}=m.useContext(be),g=u=>{w&&w(u),l&&l(u)},j={...n,expanded:C,disabled:h,disableGutters:f},S=wt(j);return s.jsxs(St,{focusRipple:!1,disableRipple:!0,disabled:h,component:"div","aria-expanded":C,className:V(S.root,d),focusVisibleClassName:V(S.focusVisible,c),onClick:g,ref:o,ownerState:j,...p,children:[s.jsx(Dt,{className:S.content,ownerState:j,children:r}),i&&s.jsx(Et,{className:S.expandIconWrapper,ownerState:j,children:i})]})}),At=({assignee:e})=>{var t;return s.jsx(q,{spacing:2,direction:"row",sx:{flexWrap:"wrap",alignItems:"center"},children:e?s.jsxs(s.Fragment,{children:[s.jsx(k,{children:"Assignee: "}),s.jsx(se,{title:((t=e.position)==null?void 0:t.name)||"Unspecified position",arrow:!0,children:s.jsx(Qe,{component:Be,to:he("",fe.Executors,e.id),avatar:s.jsx(Ve,{children:e.name[0]}),label:e.name,sx:{fontWeight:400,fontSize:18,cursor:"pointer"}})})]}):s.jsx(k,{children:"Assignee: unspecified"})})},Tt=$e(s.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown"),Pt=ne(({projectId:e})=>{var n;const t=F.getById(e),o=F.getTeam(e);return t?s.jsxs(gt,{disableGutters:!0,sx:{border:"1px solid",borderColor:oe.palette.white.dark},children:[s.jsx(Rt,{expandIcon:s.jsx(Tt,{}),sx:{fontSize:18},children:"Project information"}),s.jsx(vt,{children:s.jsxs(q,{spacing:2,sx:{alignItems:"flex-start"},children:[s.jsx(k,{children:t.description||"No description provided"}),s.jsx(At,{assignee:t==null?void 0:t.lead}),o!=null&&o.length?s.jsx(qe,{team:o,excludeId:(n=t.lead)==null?void 0:n.id}):s.jsx(k,{children:"Project team is empty"})]})})]}):s.jsx(k,{children:"Error"})}),me=(e,t)=>{if(t)return t.filter(o=>o.status===e)},It=e=>{if(e)return{transform:`translate(${e.x}px, ${e.y}px)`,zIndex:20,cursor:"grabbing"}},kt=({data:e,draggable:t})=>{const o=Ne(oe.breakpoints.up("lg"))&&t,[n,r]=m.useState(o),{id:d}=e,{attributes:i,listeners:c,setNodeRef:l,transform:p}=Je({id:d,disabled:!n}),h=It(p),f=w=>{w.stopPropagation(),r(!1)},C=()=>r(!0);return s.jsx(Ke,{data:e,ref:l,...c,...i,sx:{cursor:n?"grab":"default",...h},editBtn:s.jsx(He,{id:e.id,name:e.name,onPointerDown:f,onEditorClose:C}),deleteBtn:s.jsx(Oe,{id:e.id,name:e.name,onPointerDown:f})})},Mt=ne(({projectId:e})=>{const t=de.getByProjectId(e),o=n=>{const{active:r,over:d}=n;if(!d)return;const i=r.id,c=d.id,l=t.map(p=>i===p.id?{...p,status:c}:p);return de.update(l.find(p=>p.id===i)),l};return s.jsx(le,{container:!0,spacing:2,size:"grow",sx:{[oe.breakpoints.down("lg")]:{flexDirection:"column"}},children:s.jsx(Xe,{onDragEnd:o,children:st.map(n=>{var r,d;return s.jsx(le,{size:"grow",sx:{height:"100%",flexGrow:1},children:s.jsx(Ye,{label:n.label,tasksLength:((r=me(n.id,t))==null?void 0:r.length)||0,column:n,children:(d=me(n.id,t))==null?void 0:d.map(i=>s.jsx(kt,{data:i,draggable:!0},i.id))})},n.id)})})})}),xe=e=>e.split(".").reverse().join("-"),zt=({projectId:e,setEditedProject:t})=>{var u,D,b,T;const[o,n]=m.useState(!1),r=F.getById(e);if(!r)return s.jsx(k,{children:"Error"});const d=ot({defaultValues:{name:r.name,description:r.description,lead:((u=r.lead)==null?void 0:u.id)||ce.Unspecified,startDate:xe(r.startDate),endDate:xe(r.endDate)}}),{register:i,handleSubmit:c,getValues:l,setError:p,clearErrors:h,formState:f,reset:C,control:w}=d,{errors:g}=f,j=pe.get(),S=()=>{const P=l("startDate"),y=l("endDate"),x={name:l("name"),description:l("description"),lead:l("lead"),startDate:P,endDate:y};if(new Date(P)>new Date(y)){p("endDate",{type:"validate",message:"End date cannot be earlier than start date."});return}h("endDate");const I={...r,...x,lead:pe.getById(x.lead)};n(!0),t(I),C(x)};return s.jsx("form",{onSubmit:c(S),noValidate:!0,children:s.jsxs(q,{spacing:2,children:[s.jsx(O,{id:"project-name",label:"Name",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",error:!!g.name,helperText:(D=g.name)==null?void 0:D.message,...i("name",{required:"Name is required."})}),s.jsx(O,{id:"project-description",label:"Description",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",multiline:!0,minRows:3,maxRows:3,...i("description")}),s.jsx(nt,{control:w,name:"lead",render:({field:P})=>s.jsxs(rt,{fullWidth:!0,children:[s.jsx(at,{id:"project-lead-label",children:"Lead"}),s.jsxs(it,{id:"project-lead",labelId:"project-lead-label",label:"Lead",...P,sx:{alignSelf:"flex-start",width:"100%"},children:[s.jsx(ue,{value:ce.Unspecified,selected:!0,children:"Unspecified"}),!!(j!=null&&j.data.length)&&j.data.map(y=>s.jsx(ue,{value:y.id,children:y.name},y.id))]})]})}),s.jsx(O,{id:"project-start-date",label:"Start date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",type:"date",error:!!g.startDate,helperText:(b=g.startDate)==null?void 0:b.message,...i("startDate",{required:"Start date is required."})}),s.jsx(O,{id:"project-end-date",label:"End date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",type:"date",error:!!g.endDate,helperText:(T=g.endDate)==null?void 0:T.message,...i("endDate",{required:"End date is required."})}),s.jsxs(q,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[s.jsx(ge,{variant:"contained",disabled:!f.isDirty,type:"submit",children:"Save"}),o&&s.jsx(k,{color:"success",children:"Changes saved."})]})]})})},Bt=({id:e,name:t,onEditorClose:o,onPointerDown:n})=>{const[r,d]=m.useState(null),i=()=>{r&&F.update(r),o&&o()},{openModal:c,handleModalOpen:l,handleModalClose:p}=We(!1,i);return s.jsxs(s.Fragment,{children:[s.jsx(se,{title:"Edit",children:s.jsx(je,{size:"small",onPointerDown:n,onClick:l,children:s.jsx(Ze,{})})}),s.jsx(Le,{title:`Edit project '${t}'`,open:c,onClose:p,children:s.jsx(zt,{projectId:e,setEditedProject:d})})]})},$t=({id:e,name:t,redirectOnDelete:o})=>{const{dialog:n,handleDeleteClick:r}=_e(()=>F.delete(e),o);return s.jsxs(s.Fragment,{children:[s.jsx(se,{title:"Delete",children:s.jsx(je,{size:"small",onClick:n.handleModalOpen,children:s.jsx(et,{})})}),s.jsx(tt,{title:`Are you sure you want to delete project '${t}'?`,open:n.openModal,onClose:n.handleModalClose,actionButtons:s.jsx(ge,{color:"sensitive",variant:"contained",onClick:r,children:"Delete"})})]})},Qt=ne(({})=>{const{projectId:e}=Ue(),t=F.getById(e);return!t||!e?s.jsx(k,{children:"Error"}):s.jsxs(q,{spacing:1,sx:{height:"100%"},children:[s.jsxs(Fe,{title:t.name,children:[s.jsx(Ge,{to:"create-task",variant:"contained",children:"Add task"}),s.jsx(Bt,{id:e,name:t.name}),s.jsx($t,{id:e,name:t.name,redirectOnDelete:he("",fe.Projects)})]}),s.jsx(Pt,{projectId:e}),s.jsx(Mt,{projectId:e})]})});export{Qt as default};
