import{r as h,f as A,j as e,T as r,S as o,M as k,O as y,p as V,e as j,b as S,g as C,d as f,i as P,l as D,Q as T,k as W,c as z,s as L,R as O,u as U,h as G,P as N}from"./index-lYFP5Mbq.js";import{T as R}from"./TaskColumn-CMaXbNmY.js";import{P as $}from"./ProjectCard-B7bV5DJY.js";import{u as q,C as H,F as Q}from"./index.esm-BDWSUy-D.js";import{T as J,I as K}from"./TextField-By6Opk9u.js";import{S as X}from"./Select-iZkkjfx3.js";import{M as b}from"./MenuItem-BaMFnwzx.js";import{E as Y,o as M,D as Z,a as _,b as ee,c as te}from"./Delete-B1e0ZgLZ.js";import"./utils-Bxiod-Hf.js";const I=5,se=({executorId:s})=>{const[t,a]=h.useState(1),i=A.getAllWithExecutor(s,t,I);return i.data.length?e.jsxs(o,{spacing:1,children:[e.jsx(r,{variant:"h3",children:"Assigned to tasks"}),e.jsxs(o,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(k,{minItemWidth:"270px",spacing:2,children:i.data.map(n=>e.jsx(R,{data:n},n.id))}),e.jsx(y,{currentPage:t,setPage:a,itemsCount:i.totalCount,limit:I})]})]}):e.jsx(r,{children:"This executor has not yet been assigned to tasks"})},v=5,ne=({executorId:s})=>{const[t,a]=h.useState(1),i=V.getAllWithLead(s,t,v);return i.data.length?e.jsxs(o,{spacing:1,children:[e.jsx(r,{variant:"h3",children:"Appointed to projects"}),e.jsxs(o,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(k,{minItemWidth:"270px",spacing:2,children:i.data.map(n=>e.jsx($,{data:n},n.id))}),e.jsx(y,{currentPage:t,setPage:a,itemsCount:i.totalCount,limit:v})]})]}):e.jsx(r,{children:"This executor has not yet been appointed project lead"})},ae=({executorId:s,setEditedExecutor:t})=>{var E;const[a,i]=h.useState(!1),n=j.getById(s);if(!n)return e.jsx(r,{children:"Error"});const l=q({defaultValues:{name:n.name,position:((E=n.position)==null?void 0:E.id)||S.Unspecified}}),{register:u,handleSubmit:p,getValues:c,control:g,formState:w,reset:B}=l,m=C.get(),F=()=>{const d={name:c("name").trim(),position:c("position")},x={...n,name:d.name,position:C.getById(d.position)};console.log(d,x),i(!0),t(x),B(d)};return e.jsx("form",{onSubmit:p(F),noValidate:!0,children:e.jsxs(o,{spacing:2,children:[e.jsx(J,{id:"executor-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...u("name",{required:!0})}),e.jsx(H,{control:g,name:"position",render:({field:d})=>e.jsxs(Q,{fullWidth:!0,children:[e.jsx(K,{id:"position-label",children:"Position"}),e.jsxs(X,{id:"position",labelId:"position-label",label:"Position",...d,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(b,{value:S.Unspecified,children:"Unspecified"}),!!(m!=null&&m.length)&&m.map(x=>e.jsx(b,{value:x.id,children:x.name},x.name))]})]})}),e.jsxs(o,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(f,{variant:"contained",disabled:!w.isDirty,type:"submit",children:"Save"}),a&&e.jsx(r,{color:"success",children:"Changes saved."})]})]})})},ie=({id:s,name:t,onEditorClose:a,onPointerDown:i})=>{const[n,l]=h.useState(null),u=()=>{n&&j.update(n),a&&a()},{openModal:p,handleModalOpen:c,handleModalClose:g}=P(!1,u);return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Edit",children:e.jsx(T,{size:"small",onPointerDown:i,onClick:c,children:e.jsx(Y,{})})}),e.jsx(W,{title:`Edit task '${t}'`,open:p,onClose:g,children:e.jsx(ae,{executorId:s,setEditedExecutor:l})})]})},oe=M(({executorId:s,executorName:t,open:a,onClose:i,onDelete:n})=>{const l=()=>{j.delete(s),n&&n()};return e.jsx(Z,{open:a,children:e.jsxs(o,{spacing:2,sx:{p:2},children:[e.jsxs(_,{sx:{p:0,fontSize:20},children:["Are you sure you want to delete task '",t,"'?"]}),e.jsxs(ee,{sx:{p:0,mt:0},children:[e.jsx(f,{color:"primary",variant:"contained",onClick:i,children:"Cancel"}),e.jsx(f,{color:"sensitive",variant:"contained",onClick:l,children:"Delete"})]})]})})}),re=({id:s,name:t,onPointerDown:a,redirectOnDelete:i=!1})=>{const n=z(),l=i?()=>n(L("",O.Executors)):null,{openModal:u,handleModalOpen:p,handleModalClose:c}=P(!1);return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Delete",children:e.jsx(T,{size:"small",onPointerDown:a,onClick:p,children:e.jsx(te,{})})}),e.jsx(oe,{executorId:s,executorName:t,open:u,onClose:c,onDelete:l})]})},ge=M(()=>{var a;const{executorId:s}=U(),t=j.getById(s);return!s||!t?e.jsx(r,{children:"Error"}):e.jsxs(o,{spacing:2,children:[e.jsxs(G,{children:[e.jsxs(N,{title:t.name,children:[e.jsx(ie,{id:s,name:t.name}),e.jsx(re,{id:s,name:t.name,redirectOnDelete:!0})]}),e.jsx(r,{children:((a=t.position)==null?void 0:a.name)||"Unspecified position"})]}),e.jsxs(o,{spacing:3,children:[e.jsx(se,{executorId:s}),e.jsx(ne,{executorId:s})]})]})});export{ge as default};
