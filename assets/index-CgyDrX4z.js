import{r as u,f as w,j as e,T as o,S as r,J as P,K as k,p as F,e as m,b as E,g as S,d as v,i as A,l as y,M as B,k as V,u as W,h as L,P as U,s as z,R as G}from"./index-BKcszQKM.js";import{T as O}from"./TaskColumn-B2kAtuII.js";import{P as R}from"./ProjectCard-Ct2Ifwk9.js";import{u as $,C as q,F as H}from"./index.esm-C2g7lyzA.js";import{T as J,I as K}from"./TextField-BVlZHFqG.js";import{S as N}from"./Select-Ds_JSibu.js";import{M as C}from"./MenuItem-D_-LpAxY.js";import{E as Q,u as X,D as Y,B as Z,o as _}from"./Delete-DroR5Y-1.js";import"./utils-ishblJic.js";const b=5,ee=({executorId:s})=>{const[t,i]=u.useState(1),n=w.getAllWithExecutor(s,t,b);return n.data.length?e.jsxs(r,{spacing:1,children:[e.jsx(o,{variant:"h3",children:"Assigned to tasks"}),e.jsxs(r,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(P,{minItemWidth:"270px",spacing:2,children:n.data.map(a=>e.jsx(O,{data:a},a.id))}),e.jsx(k,{currentPage:t,setPage:i,itemsCount:n.totalCount,limit:b})]})]}):e.jsx(o,{children:"This executor has not yet been assigned to tasks"})},I=5,te=({executorId:s})=>{const[t,i]=u.useState(1),n=F.getAllWithLead(s,t,I);return n.data.length?e.jsxs(r,{spacing:1,children:[e.jsx(o,{variant:"h3",children:"Appointed to projects"}),e.jsxs(r,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(P,{minItemWidth:"270px",spacing:2,children:n.data.map(a=>e.jsx(R,{data:a},a.id))}),e.jsx(k,{currentPage:t,setPage:i,itemsCount:n.totalCount,limit:I})]})]}):e.jsx(o,{children:"This executor has not yet been appointed project lead"})},se=({executorId:s,setEditedExecutor:t})=>{var f;const[i,n]=u.useState(!1),a=m.getById(s);if(!a)return e.jsx(o,{children:"Error"});const p=$({defaultValues:{name:a.name,position:((f=a.position)==null?void 0:f.id)||E.Unspecified}}),{register:h,handleSubmit:j,getValues:d,control:g,formState:D,reset:M}=p,x=S.get(),T=()=>{const l={name:d("name").trim(),position:d("position")},c={...a,name:l.name,position:S.getById(l.position)};console.log(l,c),n(!0),t(c),M(l)};return e.jsx("form",{onSubmit:j(T),noValidate:!0,children:e.jsxs(r,{spacing:2,children:[e.jsx(J,{id:"executor-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...h("name",{required:!0})}),e.jsx(q,{control:g,name:"position",render:({field:l})=>e.jsxs(H,{fullWidth:!0,children:[e.jsx(K,{id:"position-label",children:"Position"}),e.jsxs(N,{id:"position",labelId:"position-label",label:"Position",...l,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(C,{value:E.Unspecified,children:"Unspecified"}),!!(x!=null&&x.length)&&x.map(c=>e.jsx(C,{value:c.id,children:c.name},c.name))]})]})}),e.jsxs(r,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(v,{variant:"contained",disabled:!D.isDirty,type:"submit",children:"Save"}),i&&e.jsx(o,{color:"success",children:"Changes saved."})]})]})})},ne=({id:s,name:t,onEditorClose:i,onPointerDown:n})=>{const[a,p]=u.useState(null),h=()=>{a&&m.update(a),i&&i()},{openModal:j,handleModalOpen:d,handleModalClose:g}=A(!1,h);return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Edit",children:e.jsx(B,{size:"small",onPointerDown:n,onClick:d,children:e.jsx(Q,{})})}),e.jsx(V,{title:`Edit task '${t}'`,open:j,onClose:g,children:e.jsx(se,{executorId:s,setEditedExecutor:p})})]})},ae=({id:s,name:t,redirectOnDelete:i})=>{const{dialog:n,handleDeleteClick:a}=X(()=>m.delete(s),i);return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Delete",children:e.jsx(B,{size:"small",onClick:n.handleModalOpen,children:e.jsx(Y,{})})}),e.jsx(Z,{title:`Are you sure you want to delete executor '${t}'?`,open:n.openModal,onClose:n.handleModalClose,actionButtons:e.jsx(v,{color:"sensitive",variant:"contained",onClick:a,children:"Delete"})})]})},pe=_(()=>{var i;const{executorId:s}=W(),t=m.getById(s);return!s||!t?e.jsx(o,{children:"Error"}):e.jsxs(r,{spacing:2,children:[e.jsxs(L,{children:[e.jsxs(U,{title:t.name,children:[e.jsx(ne,{id:s,name:t.name}),e.jsx(ae,{id:s,name:t.name,redirectOnDelete:z("",G.Executors)})]}),e.jsx(o,{children:((i=t.position)==null?void 0:i.name)||"Unspecified position"})]}),e.jsxs(r,{spacing:3,children:[e.jsx(ee,{executorId:s}),e.jsx(te,{executorId:s})]})]})});export{pe as default};
