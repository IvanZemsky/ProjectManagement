import{m as K,n as J,o as A,w as $,r as x,y as X,a0 as Ae,a1 as Te,A as Pe,j as s,D as q,E as Y,a2 as Ie,a3 as ke,a4 as ie,U as Me,a5 as ze,K as de,q as $e,S as F,T as k,l as oe,L as Be,s as ge,R as fe,W as We,p as G,t as re,a6 as Ne,f as le,a7 as ce,b as pe,e as ue,d as se,i as je,Q as be,k as Le,c as Ue,u as Fe,P as Ge,B as Ve}from"./index-lYFP5Mbq.js";import{A as qe,T as He,E as Oe,D as Qe}from"./DeleteTaskBtn-CBDaBqUH.js";import{C as Ke,u as Je,T as Xe,D as Ye,a as Ze}from"./TaskColumn-CMaXbNmY.js";import{o as Z,E as _e,D as et,a as tt,b as st,c as nt}from"./Delete-B1e0ZgLZ.js";import{t as ot}from"./constants-DWoOd6FE.js";import{u as rt,C as at,F as it}from"./index.esm-BDWSUy-D.js";import{T as O,I as dt}from"./TextField-By6Opk9u.js";import{S as lt}from"./Select-iZkkjfx3.js";import{M as xe}from"./MenuItem-BaMFnwzx.js";import"./utils-Bxiod-Hf.js";function ct(e){return J("MuiCollapse",e)}K("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const pt=e=>{const{orientation:t,classes:n}=e,o={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return Y(o,ct,n)},ut=A("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.orientation],n.state==="entered"&&t.entered,n.state==="exited"&&!n.in&&n.collapsedSize==="0px"&&t.hidden]}})($(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:t})=>t.state==="exited"&&!t.in&&t.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),xt=A("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),mt=A("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),ne=x.forwardRef(function(t,n){const o=X({props:t,name:"MuiCollapse"}),{addEndListener:r,children:d,className:i,collapsedSize:l="0px",component:c,easing:p,in:h,onEnter:g,onEntered:C,onEntering:D,onExit:f,onExited:j,onExiting:S,orientation:u="vertical",style:w,timeout:b=Ie.standard,TransitionComponent:T=ke,...P}=o,y={...o,orientation:u,collapsedSize:l},m=pt(y),I=Ae(),_=Te(),E=x.useRef(null),B=x.useRef(),W=typeof l=="number"?`${l}px`:l,M=u==="horizontal",z=M?"width":"height",N=x.useRef(null),ee=Pe(n,N),L=a=>v=>{if(a){const R=N.current;v===void 0?a(R):a(R,v)}},te=()=>E.current?E.current[M?"clientWidth":"clientHeight"]:0,ve=L((a,v)=>{E.current&&M&&(E.current.style.position="absolute"),a.style[z]=W,g&&g(a,v)}),Ce=L((a,v)=>{const R=te();E.current&&M&&(E.current.style.position="");const{duration:V,easing:H}=ie({style:w,timeout:b,easing:p},{mode:"enter"});if(b==="auto"){const ae=I.transitions.getAutoHeightDuration(R);a.style.transitionDuration=`${ae}ms`,B.current=ae}else a.style.transitionDuration=typeof V=="string"?V:`${V}ms`;a.style[z]=`${R}px`,a.style.transitionTimingFunction=H,D&&D(a,v)}),De=L((a,v)=>{a.style[z]="auto",C&&C(a,v)}),Se=L(a=>{a.style[z]=`${te()}px`,f&&f(a)}),we=L(j),Ee=L(a=>{const v=te(),{duration:R,easing:V}=ie({style:w,timeout:b,easing:p},{mode:"exit"});if(b==="auto"){const H=I.transitions.getAutoHeightDuration(v);a.style.transitionDuration=`${H}ms`,B.current=H}else a.style.transitionDuration=typeof R=="string"?R:`${R}ms`;a.style[z]=W,a.style.transitionTimingFunction=V,S&&S(a)}),Re=a=>{b==="auto"&&_.start(B.current||0,a),r&&r(N.current,a)};return s.jsx(T,{in:h,onEnter:ve,onEntered:De,onEntering:Ce,onExit:Se,onExited:we,onExiting:Ee,addEndListener:Re,nodeRef:N,timeout:b==="auto"?null:b,...P,children:(a,v)=>s.jsx(ut,{as:c,className:q(m.root,i,{entered:m.entered,exited:!h&&W==="0px"&&m.hidden}[a]),style:{[M?"minWidth":"minHeight"]:W,...w},ref:ee,...v,ownerState:{...y,state:a},children:s.jsx(xt,{ownerState:{...y,state:a},className:m.wrapper,ref:E,children:s.jsx(mt,{ownerState:{...y,state:a},className:m.wrapperInner,children:d})})})})});ne&&(ne.muiSupportAuto=!0);const ye=x.createContext({});function ht(e){return J("MuiAccordion",e)}const Q=K("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),gt=e=>{const{classes:t,square:n,expanded:o,disabled:r,disableGutters:d}=e;return Y({root:["root",!n&&"rounded",o&&"expanded",r&&"disabled",!d&&"gutters"],heading:["heading"],region:["region"]},ht,t)},ft=A(Me,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${Q.region}`]:t.region},t.root,!n.square&&t.rounded,!n.disableGutters&&t.gutters]}})($(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${Q.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${Q.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}}),$(({theme:e})=>({variants:[{props:t=>!t.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:t=>!t.disableGutters,style:{[`&.${Q.expanded}`]:{margin:"16px 0"}}}]}))),jt=A("h3",{name:"MuiAccordion",slot:"Heading",overridesResolver:(e,t)=>t.heading})({all:"unset"}),bt=x.forwardRef(function(t,n){const o=X({props:t,name:"MuiAccordion"}),{children:r,className:d,defaultExpanded:i=!1,disabled:l=!1,disableGutters:c=!1,expanded:p,onChange:h,square:g=!1,slots:C={},slotProps:D={},TransitionComponent:f,TransitionProps:j,...S}=o,[u,w]=ze({controlled:p,default:i,name:"Accordion",state:"expanded"}),b=x.useCallback(ee=>{w(!u),h&&h(ee,!u)},[u,h,w]),[T,...P]=x.Children.toArray(r),y=x.useMemo(()=>({expanded:u,disabled:l,disableGutters:c,toggle:b}),[u,l,c,b]),m={...o,square:g,disabled:l,disableGutters:c,expanded:u},I=gt(m),_={transition:f,...C},E={transition:j,...D},B={slots:_,slotProps:E},[W,M]=de("heading",{elementType:jt,externalForwardedProps:B,className:I.heading,ownerState:m}),[z,N]=de("transition",{elementType:ne,externalForwardedProps:B,ownerState:m});return s.jsxs(ft,{className:q(I.root,d),ref:n,ownerState:m,square:g,...S,children:[s.jsx(W,{...M,children:s.jsx(ye.Provider,{value:y,children:T})}),s.jsx(z,{in:u,timeout:"auto",...N,children:s.jsx("div",{"aria-labelledby":T.props.id,id:T.props["aria-controls"],role:"region",className:I.region,children:P})})]})});function yt(e){return J("MuiAccordionDetails",e)}K("MuiAccordionDetails",["root"]);const vt=e=>{const{classes:t}=e;return Y({root:["root"]},yt,t)},Ct=A("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})($(({theme:e})=>({padding:e.spacing(1,2,2)}))),Dt=x.forwardRef(function(t,n){const o=X({props:t,name:"MuiAccordionDetails"}),{className:r,...d}=o,i=o,l=vt(i);return s.jsx(Ct,{className:q(l.root,r),ref:n,ownerState:i,...d})});function St(e){return J("MuiAccordionSummary",e)}const U=K("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),wt=e=>{const{classes:t,expanded:n,disabled:o,disableGutters:r}=e;return Y({root:["root",n&&"expanded",o&&"disabled",!r&&"gutters"],focusVisible:["focusVisible"],content:["content",n&&"expanded",!r&&"contentGutters"],expandIconWrapper:["expandIconWrapper",n&&"expanded"]},St,t)},Et=A($e,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})($(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],t),[`&.${U.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${U.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${U.disabled})`]:{cursor:"pointer"},variants:[{props:n=>!n.disableGutters,style:{[`&.${U.expanded}`]:{minHeight:64}}}]}})),Rt=A("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})($(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:t=>!t.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${U.expanded}`]:{margin:"20px 0"}}}]}))),At=A("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})($(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${U.expanded}`]:{transform:"rotate(180deg)"}}))),Tt=x.forwardRef(function(t,n){const o=X({props:t,name:"MuiAccordionSummary"}),{children:r,className:d,expandIcon:i,focusVisibleClassName:l,onClick:c,...p}=o,{disabled:h=!1,disableGutters:g,expanded:C,toggle:D}=x.useContext(ye),f=u=>{D&&D(u),c&&c(u)},j={...o,expanded:C,disabled:h,disableGutters:g},S=wt(j);return s.jsxs(Et,{focusRipple:!1,disableRipple:!0,disabled:h,component:"div","aria-expanded":C,className:q(S.root,d),focusVisibleClassName:q(S.focusVisible,l),onClick:f,ref:n,ownerState:j,...p,children:[s.jsx(Rt,{className:S.content,ownerState:j,children:r}),i&&s.jsx(At,{className:S.expandIconWrapper,ownerState:j,children:i})]})}),Pt=({assignee:e})=>{var t;return s.jsx(F,{spacing:2,direction:"row",sx:{flexWrap:"wrap",alignItems:"center"},children:e?s.jsxs(s.Fragment,{children:[s.jsx(k,{children:"Assignee: "}),s.jsx(oe,{title:((t=e.position)==null?void 0:t.name)||"Unspecified position",arrow:!0,children:s.jsx(Ke,{component:Be,to:ge("",fe.Executors,e.id),avatar:s.jsx(qe,{children:e.name[0]}),label:e.name,sx:{fontWeight:400,fontSize:18,cursor:"pointer"}})})]}):s.jsx(k,{children:"Assignee: unspecified"})})},It=We(s.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown"),kt=Z(({projectId:e})=>{var o;const t=G.getById(e),n=G.getTeam(e);return t?s.jsxs(bt,{disableGutters:!0,sx:{border:"1px solid",borderColor:re.palette.white.dark},children:[s.jsx(Tt,{expandIcon:s.jsx(It,{}),sx:{fontSize:18},children:"Project information"}),s.jsx(Dt,{children:s.jsxs(F,{spacing:2,sx:{alignItems:"flex-start"},children:[s.jsx(k,{children:t.description||"No description provided"}),s.jsx(Pt,{assignee:t==null?void 0:t.lead}),n!=null&&n.length?s.jsx(He,{team:n,excludeId:(o=t.lead)==null?void 0:o.id}):s.jsx(k,{children:"Project team is empty"})]})})]}):s.jsx(k,{children:"Error"})}),me=(e,t)=>{if(t)return t.filter(n=>n.status===e)},Mt=e=>{if(e)return{transform:`translate(${e.x}px, ${e.y}px)`,zIndex:20,cursor:"grabbing"}},zt=({data:e,draggable:t})=>{const n=Ne(re.breakpoints.up("lg"))&&t,[o,r]=x.useState(n),{id:d}=e,{attributes:i,listeners:l,setNodeRef:c,transform:p}=Je({id:d,disabled:!o}),h=Mt(p),g=D=>{D.stopPropagation(),r(!1)},C=()=>r(!0);return s.jsx(Xe,{data:e,ref:c,...l,...i,sx:{cursor:o?"grab":"default",...h},editBtn:s.jsx(Oe,{id:e.id,name:e.name,onPointerDown:g,onEditorClose:C}),deleteBtn:s.jsx(Qe,{id:e.id,name:e.name,onPointerDown:g})})},$t=Z(({projectId:e})=>{const t=le.getByProjectId(e),n=o=>{const{active:r,over:d}=o;if(!d)return;const i=r.id,l=d.id,c=t.map(p=>i===p.id?{...p,status:l}:p);return le.update(c.find(p=>p.id===i)),c};return s.jsx(ce,{container:!0,spacing:2,size:"grow",sx:{[re.breakpoints.down("lg")]:{flexDirection:"column"}},children:s.jsx(Ye,{onDragEnd:n,children:ot.map(o=>{var r,d;return s.jsx(ce,{size:"grow",sx:{height:"100%",flexGrow:1},children:s.jsx(Ze,{label:o.label,tasksLength:((r=me(o.id,t))==null?void 0:r.length)||0,column:o,children:(d=me(o.id,t))==null?void 0:d.map(i=>s.jsx(zt,{data:i,draggable:!0},i.id))})},o.id)})})})}),he=e=>e.split(".").reverse().join("-"),Bt=({projectId:e,setEditedProject:t})=>{var u,w,b,T;const[n,o]=x.useState(!1),r=G.getById(e);if(!r)return s.jsx(k,{children:"Error"});const d=rt({defaultValues:{name:r.name,description:r.description,lead:((u=r.lead)==null?void 0:u.id)||pe.Unspecified,startDate:he(r.startDate),endDate:he(r.endDate)}}),{register:i,handleSubmit:l,getValues:c,setError:p,clearErrors:h,formState:g,reset:C,control:D}=d,{errors:f}=g,j=ue.get(),S=()=>{const P=c("startDate"),y=c("endDate"),m={name:c("name"),description:c("description"),lead:c("lead"),startDate:P,endDate:y};if(new Date(P)>new Date(y)){p("endDate",{type:"validate",message:"End date cannot be earlier than start date."});return}h("endDate");const I={...r,...m,lead:ue.getById(m.lead)};o(!0),t(I),C(m)};return s.jsx("form",{onSubmit:l(S),noValidate:!0,children:s.jsxs(F,{spacing:2,children:[s.jsx(O,{id:"project-name",label:"Name",variant:"filled",sx:{alignSelf:"flex-start",maxWidth:400,width:"100%"},size:"small",error:!!f.name,helperText:(w=f.name)==null?void 0:w.message,...i("name",{required:"Name is required."})}),s.jsx(O,{id:"project-description",label:"Description",variant:"filled",sx:{alignSelf:"flex-start",maxWidth:400,width:"100%"},size:"small",multiline:!0,minRows:3,maxRows:3,...i("description")}),s.jsx(at,{control:D,name:"lead",render:({field:P})=>s.jsxs(it,{fullWidth:!0,children:[s.jsx(dt,{id:"project-lead-label",children:"Lead"}),s.jsxs(lt,{id:"project-lead",labelId:"project-lead-label",label:"Lead",...P,sx:{alignSelf:"flex-start",maxWidth:400,width:"100%"},children:[s.jsx(xe,{value:pe.Unspecified,selected:!0,children:"Unspecified"}),!!(j!=null&&j.data.length)&&j.data.map(y=>s.jsx(xe,{value:y.id,children:y.name},y.id))]})]})}),s.jsx(O,{id:"project-start-date",label:"Start date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",maxWidth:400,width:"100%"},size:"small",type:"date",error:!!f.startDate,helperText:(b=f.startDate)==null?void 0:b.message,...i("startDate",{required:"Start date is required."})}),s.jsx(O,{id:"project-end-date",label:"End date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",maxWidth:400,width:"100%"},size:"small",type:"date",error:!!f.endDate,helperText:(T=f.endDate)==null?void 0:T.message,...i("endDate",{required:"End date is required."})}),s.jsxs(F,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[s.jsx(se,{variant:"contained",disabled:!g.isDirty,type:"submit",children:"Save"}),n&&s.jsx(k,{color:"success",children:"Changes saved."})]})]})})},Wt=({id:e,name:t,onEditorClose:n,onPointerDown:o})=>{const[r,d]=x.useState(null),i=()=>{r&&G.update(r),n&&n()},{openModal:l,handleModalOpen:c,handleModalClose:p}=je(!1,i);return s.jsxs(s.Fragment,{children:[s.jsx(oe,{title:"Edit",children:s.jsx(be,{size:"small",onPointerDown:o,onClick:c,children:s.jsx(_e,{})})}),s.jsx(Le,{title:`Edit project '${t}'`,open:l,onClose:p,children:s.jsx(Bt,{projectId:e,setEditedProject:d})})]})},Nt=Z(({projectId:e,projectName:t,open:n,onClose:o,onDelete:r})=>{const d=()=>{G.delete(e),r&&r()};return s.jsx(et,{open:n,children:s.jsxs(F,{spacing:2,sx:{p:2},children:[s.jsxs(tt,{sx:{p:0,fontSize:20},children:["Are you sure you want to delete project '",t,"'?"]}),s.jsxs(st,{sx:{p:0,mt:0},children:[s.jsx(se,{color:"primary",variant:"contained",onClick:o,children:"Cancel"}),s.jsx(se,{color:"sensitive",variant:"contained",onClick:d,children:"Delete"})]})]})})}),Lt=({id:e,name:t,redirectOnDelete:n=!1})=>{const o=Ue(),r=n?()=>o(ge("",fe.Projects)):null,{openModal:d,handleModalOpen:i,handleModalClose:l}=je(!1);return s.jsxs(s.Fragment,{children:[s.jsx(oe,{title:"Delete",children:s.jsx(be,{size:"small",onClick:i,children:s.jsx(nt,{})})}),s.jsx(Nt,{projectId:e,projectName:t,open:d,onClose:l,onDelete:r})]})},Xt=Z(({})=>{const{projectId:e}=Fe(),t=G.getById(e);return!t||!e?s.jsx(k,{children:"Error"}):s.jsxs(F,{spacing:1,sx:{height:"100%"},children:[s.jsxs(Ge,{title:t.name,children:[s.jsx(Ve,{to:"create-task",variant:"contained",children:"Add task"}),s.jsx(Wt,{id:e,name:t.name}),s.jsx(Lt,{id:e,name:t.name,redirectOnDelete:!0})]}),s.jsx(kt,{projectId:e}),s.jsx($t,{projectId:e})]})});export{Xt as default};
