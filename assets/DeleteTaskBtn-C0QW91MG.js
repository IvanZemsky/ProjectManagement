import{W,j as e,m as q,n as O,o as w,w as $,r as h,y as H,Q,D as G,E as J,S as y,l as C,L as K,s as X,R as Y,u as Z,T as S,f as D,b as T,e as R,d as U,i as _,M as L,k as ee}from"./index-BKcszQKM.js";import{C as se}from"./TaskColumn-B2kAtuII.js";import{t as te}from"./constants-DWoOd6FE.js";import{u as ae,C as E,F}from"./index.esm-C2g7lyzA.js";import{T as P,I as B}from"./TextField-BVlZHFqG.js";import{S as z}from"./Select-Ds_JSibu.js";import{M as I}from"./MenuItem-D_-LpAxY.js";import{E as re,u as oe,D as ie,B as le}from"./Delete-DroR5Y-1.js";const ne=W(e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function de(s){return O("MuiAvatar",s)}q("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const ce=s=>{const{classes:t,variant:a,colorDefault:l}=s;return J({root:["root",a,l&&"colorDefault"],img:["img"],fallback:["fallback"]},de,t)},ue=w("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:a}=s;return[t.root,t[a.variant],a.colorDefault&&t.colorDefault]}})($(({theme:s})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:s.typography.fontFamily,fontSize:s.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(s.vars||s).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(s.vars||s).palette.background.default,...s.vars?{backgroundColor:s.vars.palette.Avatar.defaultBg}:{backgroundColor:s.palette.grey[400],...s.applyStyles("dark",{backgroundColor:s.palette.grey[600]})}}}]}))),pe=w("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(s,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),me=w(ne,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(s,t)=>t.fallback})({width:"75%",height:"75%"});function fe({crossOrigin:s,referrerPolicy:t,src:a,srcSet:l}){const[o,r]=h.useState(!1);return h.useEffect(()=>{if(!a&&!l)return;r(!1);let i=!0;const n=new Image;return n.onload=()=>{i&&r("loaded")},n.onerror=()=>{i&&r("error")},n.crossOrigin=s,n.referrerPolicy=t,n.src=a,l&&(n.srcset=l),()=>{i=!1}},[s,t,a,l]),o}const ge=h.forwardRef(function(t,a){const l=H({props:t,name:"MuiAvatar"}),{alt:o,children:r,className:i,component:n="div",slots:m={},slotProps:u={},imgProps:f,sizes:j,src:g,srcSet:p,variant:k="circular",...v}=l;let d=null;const c=fe({...f,src:g,srcSet:p}),A=g||p,M=A&&c!=="error",x={...l,colorDefault:!M,component:n,variant:k};delete x.ownerState;const b=ce(x),[N,V]=Q("img",{className:b.img,elementType:pe,externalForwardedProps:{slots:m,slotProps:{img:{...f,...u.img}}},additionalProps:{alt:o,src:g,srcSet:p,sizes:j},ownerState:x});return M?d=e.jsx(N,{...V}):r||r===0?d=r:A&&o?d=o[0]:d=e.jsx(me,{ownerState:x,className:b.fallback}),e.jsx(ue,{as:n,className:G(b.root,i),ref:a,...v,ownerState:x,children:d})}),we=({team:s,excludeId:t,onDelete:a,editBtn:l,links:o=!0})=>{const r=s.filter(i=>i.id!==t);return e.jsxs(y,{direction:"row",sx:{flexWrap:"wrap",alignItems:"flex-start",gap:1},children:[l,r.map(i=>{var n;return e.jsx(C,{title:((n=i.position)==null?void 0:n.name)||"Unspecified position",arrow:!0,children:e.jsx(se,{component:o?K:"div",to:o?X("",Y.Executors,i.id):void 0,avatar:e.jsx(ge,{children:i.name[0]}),label:i.name,sx:{fontWeight:400,fontSize:18,cursor:"pointer"},onDelete:a?()=>a(i.id):void 0})},i.id)})]})},xe=({taskId:s,setEditedTask:t})=>{var v;const[a,l]=h.useState(!1),{projectId:o}=Z();if(!o)return e.jsx(S,{children:"Error"});const r=D.getById(s);if(!r)return e.jsx(S,{children:"Error"});const i=ae({defaultValues:{name:r.name,description:r.description,assigneeId:((v=r.assignee)==null?void 0:v.id)||T.Unspecified,status:r.status}}),{register:n,handleSubmit:m,getValues:u,control:f,formState:j,reset:g}=i,p=R.get(),k=()=>{const d={name:u("name").trim(),description:u("description").trim(),assigneeId:u("assigneeId"),status:u("status")},c={...r,name:d.name,description:d.description,status:d.status,assignee:R.getById(d.assigneeId)};l(!0),t(c),g(d)};return e.jsx("form",{onSubmit:m(k),noValidate:!0,children:e.jsxs(y,{spacing:2,children:[e.jsx(P,{id:"task-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...n("name",{required:!0})}),e.jsx(P,{id:"task-description",label:"Description",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",multiline:!0,minRows:3,maxRows:3,...n("description")}),e.jsx(E,{control:f,name:"assigneeId",render:({field:d})=>e.jsxs(F,{fullWidth:!0,children:[e.jsx(B,{id:"task-assignee-label",children:"Assignee"}),e.jsxs(z,{id:"task-assignee",labelId:"task-assignee-label",label:"Assignee",...d,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(I,{value:T.Unspecified,children:"Unspecified"}),p==null?void 0:p.data.map(c=>e.jsx(I,{value:c.id,children:c.name},c.id))]})]})}),e.jsx(E,{control:f,name:"status",render:({field:d})=>e.jsxs(F,{fullWidth:!0,children:[e.jsx(B,{id:"task-status-label",children:"Status"}),e.jsx(z,{id:"task-status",labelId:"task-status-label",label:"Status",...d,sx:{alignSelf:"flex-start",width:"100%"},children:te.map(c=>e.jsx(I,{value:c.id,children:c.label},c.id))})]})}),e.jsxs(y,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(U,{variant:"contained",disabled:!j.isDirty,type:"submit",children:"Save"}),a&&e.jsx(S,{color:"success",children:"Changes saved."})]})]})})},Ce=({id:s,name:t,onEditorClose:a,onPointerDown:l})=>{const[o,r]=h.useState(null),i=()=>{o&&D.update(o),a&&a()},{openModal:n,handleModalOpen:m,handleModalClose:u}=_(!1,i);return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Edit",children:e.jsx(L,{size:"small",onPointerDown:l,onClick:m,children:e.jsx(re,{})})}),e.jsx(ee,{title:`Edit task '${t}'`,open:n,onClose:u,children:e.jsx(xe,{taskId:s,setEditedTask:r})})]})},De=({id:s,name:t,onPointerDown:a,redirectOnDelete:l})=>{const{dialog:o,handleDeleteClick:r}=oe(()=>D.delete(s),l);return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"Delete",children:e.jsx(L,{size:"small",onPointerDown:a,onClick:o.handleModalOpen,children:e.jsx(ie,{})})}),e.jsx(le,{title:`Are you sure you want to delete task '${t}'?`,open:o.openModal,onClose:o.handleModalClose,actionButtons:e.jsx(U,{color:"sensitive",variant:"contained",onClick:r,children:"Delete"})})]})};export{ge as A,De as D,Ce as E,we as T};
