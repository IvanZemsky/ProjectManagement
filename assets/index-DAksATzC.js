import{M as E,j as e,l as na,m as ia,n as Q,G as n,q as ca,w as k,I as h,r as b,x as da,z as pa,o as F,C as j,D as ua,O as ga,Q as fa,S as I,T as w,B as J,a as ba,b as N,e as va,c as xa,h as Ca,U as $a,g as ka,V as O,t as ma,d as ya,i as Sa}from"./index-saYaPf9d.js";import{p as ja}from"./storage-Bbm2pC8S.js";import{T as Ia,u as ha,a as T,t as X,b as wa,D as Ta,c as Da}from"./TaskColumn-BiVyj3J4.js";import{u as Pa,C as U}from"./index.esm-C3fqE1Ih.js";import{T as W,F as K,I as A}from"./TextField-DDj7DV_z.js";import{S as G}from"./Select-Cn-JDl28.js";import{M as R}from"./MenuItem-BCi1nPQf.js";import"./useFormControl-Cqs0eR1L.js";const za=E(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function Ra(a){return ia("MuiChip",a)}const r=na("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),Oa=a=>{const{classes:o,disabled:t,size:l,color:s,iconColor:p,onDelete:i,clickable:c,variant:d}=a,g={root:["root",d,t&&"disabled",`size${n(l)}`,`color${n(s)}`,c&&"clickable",c&&`clickableColor${n(s)}`,i&&"deletable",i&&`deletableColor${n(s)}`,`${d}${n(s)}`],label:["label",`label${n(l)}`],avatar:["avatar",`avatar${n(l)}`,`avatarColor${n(s)}`],icon:["icon",`icon${n(l)}`,`iconColor${n(p)}`],deleteIcon:["deleteIcon",`deleteIcon${n(l)}`,`deleteIconColor${n(s)}`,`deleteIcon${n(d)}Color${n(s)}`]};return ua(g,Ra,o)},Ea=Q("div",{name:"MuiChip",slot:"Root",overridesResolver:(a,o)=>{const{ownerState:t}=a,{color:l,iconColor:s,clickable:p,onDelete:i,size:c,variant:d}=t;return[{[`& .${r.avatar}`]:o.avatar},{[`& .${r.avatar}`]:o[`avatar${n(c)}`]},{[`& .${r.avatar}`]:o[`avatarColor${n(l)}`]},{[`& .${r.icon}`]:o.icon},{[`& .${r.icon}`]:o[`icon${n(c)}`]},{[`& .${r.icon}`]:o[`iconColor${n(s)}`]},{[`& .${r.deleteIcon}`]:o.deleteIcon},{[`& .${r.deleteIcon}`]:o[`deleteIcon${n(c)}`]},{[`& .${r.deleteIcon}`]:o[`deleteIconColor${n(l)}`]},{[`& .${r.deleteIcon}`]:o[`deleteIcon${n(d)}Color${n(l)}`]},o.root,o[`size${n(c)}`],o[`color${n(l)}`],p&&o.clickable,p&&l!=="default"&&o[`clickableColor${n(l)})`],i&&o.deletable,i&&l!=="default"&&o[`deletableColor${n(l)}`],o[d],o[`${d}${n(l)}`]]}})(ca(({theme:a})=>{const o=a.palette.mode==="light"?a.palette.grey[700]:a.palette.grey[300];return{maxWidth:"100%",fontFamily:a.typography.fontFamily,fontSize:a.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(a.vars||a).palette.text.primary,backgroundColor:(a.vars||a).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:a.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${r.disabled}`]:{opacity:(a.vars||a).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${r.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:a.vars?a.vars.palette.Chip.defaultAvatarColor:o,fontSize:a.typography.pxToRem(12)},[`& .${r.avatarColorPrimary}`]:{color:(a.vars||a).palette.primary.contrastText,backgroundColor:(a.vars||a).palette.primary.dark},[`& .${r.avatarColorSecondary}`]:{color:(a.vars||a).palette.secondary.contrastText,backgroundColor:(a.vars||a).palette.secondary.dark},[`& .${r.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:a.typography.pxToRem(10)},[`& .${r.icon}`]:{marginLeft:5,marginRight:-6},[`& .${r.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.26)`:k(a.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:a.vars?`rgba(${a.vars.palette.text.primaryChannel} / 0.4)`:k(a.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${r.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${r.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(a.palette).filter(h(["contrastText"])).map(([t])=>({props:{color:t},style:{backgroundColor:(a.vars||a).palette[t].main,color:(a.vars||a).palette[t].contrastText,[`& .${r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[t].contrastTextChannel} / 0.7)`:k(a.palette[t].contrastText,.7),"&:hover, &:active":{color:(a.vars||a).palette[t].contrastText}}}})),{props:t=>t.iconColor===t.color,style:{[`& .${r.icon}`]:{color:a.vars?a.vars.palette.Chip.defaultIconColor:o}}},{props:t=>t.iconColor===t.color&&t.color!=="default",style:{[`& .${r.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:k(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)}}},...Object.entries(a.palette).filter(h(["dark"])).map(([t])=>({props:{color:t,onDelete:!0},style:{[`&.${r.focusVisible}`]:{background:(a.vars||a).palette[t].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.hoverOpacity}))`:k(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette.action.selectedChannel} / calc(${a.vars.palette.action.selectedOpacity} + ${a.vars.palette.action.focusOpacity}))`:k(a.palette.action.selected,a.palette.action.selectedOpacity+a.palette.action.focusOpacity)},"&:active":{boxShadow:(a.vars||a).shadows[1]}}},...Object.entries(a.palette).filter(h(["dark"])).map(([t])=>({props:{color:t,clickable:!0},style:{[`&:hover, &.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette[t].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:a.vars?`1px solid ${a.vars.palette.Chip.defaultBorder}`:`1px solid ${a.palette.mode==="light"?a.palette.grey[400]:a.palette.grey[700]}`,[`&.${r.clickable}:hover`]:{backgroundColor:(a.vars||a).palette.action.hover},[`&.${r.focusVisible}`]:{backgroundColor:(a.vars||a).palette.action.focus},[`& .${r.avatar}`]:{marginLeft:4},[`& .${r.avatarSmall}`]:{marginLeft:2},[`& .${r.icon}`]:{marginLeft:4},[`& .${r.iconSmall}`]:{marginLeft:2},[`& .${r.deleteIcon}`]:{marginRight:5},[`& .${r.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(a.palette).filter(h()).map(([t])=>({props:{variant:"outlined",color:t},style:{color:(a.vars||a).palette[t].main,border:`1px solid ${a.vars?`rgba(${a.vars.palette[t].mainChannel} / 0.7)`:k(a.palette[t].main,.7)}`,[`&.${r.clickable}:hover`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[t].mainChannel} / ${a.vars.palette.action.hoverOpacity})`:k(a.palette[t].main,a.palette.action.hoverOpacity)},[`&.${r.focusVisible}`]:{backgroundColor:a.vars?`rgba(${a.vars.palette[t].mainChannel} / ${a.vars.palette.action.focusOpacity})`:k(a.palette[t].main,a.palette.action.focusOpacity)},[`& .${r.deleteIcon}`]:{color:a.vars?`rgba(${a.vars.palette[t].mainChannel} / 0.7)`:k(a.palette[t].main,.7),"&:hover, &:active":{color:(a.vars||a).palette[t].main}}}}))]}})),Ma=Q("span",{name:"MuiChip",slot:"Label",overridesResolver:(a,o)=>{const{ownerState:t}=a,{size:l}=t;return[o.label,o[`label${n(l)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function H(a){return a.key==="Backspace"||a.key==="Delete"}const Va=b.forwardRef(function(o,t){const l=da({props:o,name:"MuiChip"}),{avatar:s,className:p,clickable:i,color:c="default",component:d,deleteIcon:g,disabled:u=!1,icon:x,label:$,onClick:y,onDelete:C,onKeyDown:m,onKeyUp:v,size:Y="medium",variant:Z="filled",tabIndex:_,skipFocusWhenDisabled:aa=!1,...ea}=l,ta=b.useRef(null),oa=pa(ta,t),M=f=>{f.stopPropagation(),C&&C(f)},ra=f=>{f.currentTarget===f.target&&H(f)&&f.preventDefault(),m&&m(f)},sa=f=>{f.currentTarget===f.target&&C&&H(f)&&C(f),v&&v(f)},D=i!==!1&&y?!0:i,P=D||C?F:d||"div",z={...l,component:P,disabled:u,size:Y,color:c,iconColor:b.isValidElement(x)&&x.props.color||c,onDelete:!!C,clickable:D,variant:Z},S=Oa(z),la=P===F?{component:d||"div",focusVisibleClassName:S.focusVisible,...C&&{disableRipple:!0}}:{};let V=null;C&&(V=g&&b.isValidElement(g)?b.cloneElement(g,{className:j(g.props.className,S.deleteIcon),onClick:M}):e.jsx(za,{className:j(S.deleteIcon),onClick:M}));let L=null;s&&b.isValidElement(s)&&(L=b.cloneElement(s,{className:j(S.avatar,s.props.className)}));let B=null;return x&&b.isValidElement(x)&&(B=b.cloneElement(x,{className:j(S.icon,x.props.className)})),e.jsxs(Ea,{as:P,className:j(S.root,p),disabled:D&&u?!0:void 0,onClick:y,onKeyDown:ra,onKeyUp:sa,ref:oa,tabIndex:aa&&u?-1:_,ownerState:z,...la,...ea,children:[L||B,e.jsx(Ma,{className:j(S.label),ownerState:z,children:$}),V]})}),La=()=>{const a=b.useContext(Ia);if(!a)throw new Error("useTasksContext must be used within a TasksContextProvider");return a},Ba=E(e.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"Group"),Fa=({data:a,isDraggable:o=!1,editBtn:t,deleteBtn:l})=>{const{id:s,name:p,assignee:i}=a,{attributes:c,listeners:d,setNodeRef:g,transform:u}=ha({id:s,disabled:!o}),x=y=>{y.stopPropagation()},$=u?{transform:`translate(${u.x}px, ${u.y}px)`,zIndex:20,cursor:"grabbing"}:void 0;return e.jsx(ga,{ref:g,...d,...c,variant:"outlined",sx:{position:"relative",textDecoration:"none",":hover":{boxShadow:5},zIndex:1,flexShrink:0,cursor:"grab",...$},onClick:y=>y.stopPropagation(),children:e.jsx(fa,{children:e.jsxs(I,{spacing:1,children:[e.jsx(w,{sx:{fontWeight:"600"},children:p}),e.jsxs(I,{direction:"row",spacing:1,sx:{justifyContent:"space-between"},children:[e.jsx(w,{children:(i==null?void 0:i.name)||"Unspecified lead"}),e.jsx(Va,{label:"0",icon:e.jsx(Ba,{}),size:"small"})]}),e.jsxs(I,{direction:"row",spacing:1,sx:{alignItems:"center"},children:[e.jsx(J,{to:ba.Home,variant:"outlined",size:"small",sx:{alignSelf:"flex-start"},onPointerDown:x,children:"Open"}),t,l]})]})})})},q=(a,o)=>{if(o)return o.filter(t=>t.status===a)},Na=a=>T.getByProjectId(a)||[],Ua=E(e.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit"),Wa=({taskId:a,setEditedTask:o})=>{var C;const[t,l]=b.useState(!1),s=T.getById(a);if(!s)return e.jsx(w,{children:"Error"});const p=Pa({defaultValues:{name:s.name,description:s.description,assigneeId:((C=s.assignee)==null?void 0:C.id)||N.Unspecified,status:s.status}}),{register:i,handleSubmit:c,getValues:d,control:g,formState:u,reset:x}=p,$=va.get(),y=()=>{const m={name:d("name").trim(),description:d("description").trim(),assigneeId:d("assigneeId"),status:d("status")},v=T.updateOne(a,m);v&&(l(!0),o(v),x(m))};return e.jsx("form",{onSubmit:c(y),noValidate:!0,children:e.jsxs(I,{spacing:2,children:[e.jsx(W,{id:"task-name",label:"Name",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",...i("name",{required:!0})}),e.jsx(W,{id:"task-description",label:"Description",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",multiline:!0,minRows:3,maxRows:3,...i("description")}),e.jsx(U,{control:g,name:"assigneeId",render:({field:m})=>e.jsxs(K,{fullWidth:!0,children:[e.jsx(A,{id:"task-assignee-label",children:"Assignee"}),e.jsxs(G,{id:"task-assignee",labelId:"task-assignee-label",label:"Assignee",...m,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(R,{value:N.Unspecified,children:"Unspecified"}),$==null?void 0:$.data.map(v=>e.jsx(R,{value:v.id,children:v.name},v.id))]})]})}),e.jsx(U,{control:g,name:"status",render:({field:m})=>e.jsxs(K,{fullWidth:!0,children:[e.jsx(A,{id:"task-status-label",children:"Status"}),e.jsx(G,{id:"task-status",labelId:"task-status-label",label:"Status",...m,sx:{alignSelf:"flex-start",width:"100%"},children:X.map(v=>e.jsx(R,{value:v.id,children:v.label},v.id))})]})}),e.jsxs(I,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(xa,{variant:"contained",disabled:!u.isDirty,type:"submit",children:"Save"}),t&&e.jsx(w,{color:"success",children:"Changes saved."})]})]})})},Ka=({id:a,name:o,onEditorClose:t,onPointerDown:l})=>{const[s,p]=b.useState(null),{tasks:i,setTasks:c}=La(),d=()=>{s&&c(i.map($=>$.id===a?s:$)),t&&t()},{openModal:g,handleModalOpen:u,handleModalClose:x}=Ca(!1,d);return e.jsxs(e.Fragment,{children:[e.jsx($a,{size:"small",onPointerDown:l,onClick:u,children:e.jsx(Ua,{})}),e.jsx(ka,{title:`Edit task '${o}'`,open:g,onClose:x,children:e.jsx(Wa,{taskId:a,setEditedTask:p})})]})},Aa=({data:a,isDraggable:o})=>{const[t,l]=b.useState(o),s=i=>{i.stopPropagation(),l(!1)},p=()=>l(!0);return e.jsx(Fa,{data:a,isDraggable:t,editBtn:e.jsx(Ka,{id:a.id,name:a.name,onPointerDown:s,onEditorClose:p})})},Ga=({projectId:a})=>{const[o,t]=b.useState(()=>Na(a)),l=s=>{const{active:p,over:i}=s;if(!i)return;const c=p.id,d=i.id;t(()=>{const g=o.map(u=>c===u.id?{...u,status:d}:u);return T.update(c,g.find(u=>u.id===c)),g})};return e.jsx(O,{container:!0,spacing:2,size:"grow",sx:{[ma.breakpoints.down("lg")]:{flexDirection:"column"}},children:e.jsx(wa,{tasks:o,setTasks:t,children:e.jsx(Ta,{onDragEnd:l,children:X.map(s=>{var p,i;return e.jsx(O,{size:"grow",sx:{height:"100%",flexGrow:1},children:e.jsx(Da,{label:s.label,tasksLength:((p=q(s.id,o))==null?void 0:p.length)||0,column:s,children:(i=q(s.id,o))==null?void 0:i.map(c=>e.jsx(Aa,{data:c,isDraggable:!0},c.id))})},s.id)})})})})},ae=({})=>{const{id:a}=ya(),o=ja.getById(a);return o?e.jsxs(O,{container:!0,direction:"column",sx:{height:"100%"},children:[e.jsx(Sa,{title:o.name,children:e.jsx(J,{to:"create-task",variant:"contained",children:"Add task"})}),e.jsx(Ga,{projectId:a})]}):e.jsx("p",{children:"Error"})};export{ae as default};
