import{g as K,a as Q,s as A,m as z,r as m,u as X,q as we,v as Ee,w as Re,j as s,h as V,i as Y,x as Ae,y as Te,z as re,P as Pe,C as Ie,D as ae,b as Me,l as ke,T as F,t as se,S as J,E as ze,G as ie,F as de,H as xe,o as Be,I as ge,J as fe,n as $e,K as Ne,B as Ge,M as We,R as Fe}from"./index-DW7niEK_.js";import{p as L,t as le,e as ce}from"./store-DDDbk47J.js";import{P as Le}from"./PageHeader-BcXiUKO0.js";import{o as oe,E as Ue,u as Ve,D as He,B as qe}from"./Delete-CcYEeSlv.js";import{A as Oe,T as Je,E as Ke,D as Qe}from"./DeleteTaskBtn-DyCf6E-3.js";import{t as Xe}from"./constants-DWoOd6FE.js";import{u as Ye,T as Ze,D as _e,a as et}from"./TaskColumn-Cf5tcA9W.js";import{u as tt,C as st,F as ot}from"./index.esm-BZsw8hz4.js";import{T as q,I as nt}from"./TextField-D9CnMREb.js";import{S as rt}from"./Select-DnoR1PEi.js";import{M as pe}from"./MenuItem-3KFYzs4i.js";import"./CardContent-DhbWX8Eh.js";import"./utils-C_uqNxTM.js";function at(e){return Q("MuiCollapse",e)}K("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const it=e=>{const{orientation:t,classes:o}=e,n={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return Y(n,at,o)},dt=A("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[o.orientation],o.state==="entered"&&t.entered,o.state==="exited"&&!o.in&&o.collapsedSize==="0px"&&t.hidden]}})(z(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:t})=>t.state==="exited"&&!t.in&&t.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),lt=A("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),ct=A("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,t)=>t.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),te=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiCollapse"}),{addEndListener:r,children:d,className:i,collapsedSize:c="0px",component:l,easing:p,in:g,onEnter:f,onEntered:C,onEntering:D,onExit:h,onExited:b,onExiting:S,orientation:u="vertical",style:w,timeout:j=Ae.standard,TransitionComponent:T=Te,...P}=n,y={...n,orientation:u,collapsedSize:c},x=it(y),I=we(),Z=Ee(),E=m.useRef(null),B=m.useRef(),$=typeof c=="number"?`${c}px`:c,M=u==="horizontal",k=M?"width":"height",N=m.useRef(null),_=Re(o,N),G=a=>v=>{if(a){const R=N.current;v===void 0?a(R):a(R,v)}},ee=()=>E.current?E.current[M?"clientWidth":"clientHeight"]:0,be=G((a,v)=>{E.current&&M&&(E.current.style.position="absolute"),a.style[k]=$,f&&f(a,v)}),je=G((a,v)=>{const R=ee();E.current&&M&&(E.current.style.position="");const{duration:U,easing:H}=re({style:w,timeout:j,easing:p},{mode:"enter"});if(j==="auto"){const ne=I.transitions.getAutoHeightDuration(R);a.style.transitionDuration=`${ne}ms`,B.current=ne}else a.style.transitionDuration=typeof U=="string"?U:`${U}ms`;a.style[k]=`${R}px`,a.style.transitionTimingFunction=H,D&&D(a,v)}),ye=G((a,v)=>{a.style[k]="auto",C&&C(a,v)}),ve=G(a=>{a.style[k]=`${ee()}px`,h&&h(a)}),Ce=G(b),De=G(a=>{const v=ee(),{duration:R,easing:U}=re({style:w,timeout:j,easing:p},{mode:"exit"});if(j==="auto"){const H=I.transitions.getAutoHeightDuration(v);a.style.transitionDuration=`${H}ms`,B.current=H}else a.style.transitionDuration=typeof R=="string"?R:`${R}ms`;a.style[k]=$,a.style.transitionTimingFunction=U,S&&S(a)}),Se=a=>{j==="auto"&&Z.start(B.current||0,a),r&&r(N.current,a)};return s.jsx(T,{in:g,onEnter:be,onEntered:ye,onEntering:je,onExit:ve,onExited:Ce,onExiting:De,addEndListener:Se,nodeRef:N,timeout:j==="auto"?null:j,...P,children:(a,v)=>s.jsx(dt,{as:l,className:V(x.root,i,{entered:x.entered,exited:!g&&$==="0px"&&x.hidden}[a]),style:{[M?"minWidth":"minHeight"]:$,...w},ref:_,...v,ownerState:{...y,state:a},children:s.jsx(lt,{ownerState:{...y,state:a},className:x.wrapper,ref:E,children:s.jsx(ct,{ownerState:{...y,state:a},className:x.wrapperInner,children:d})})})})});te&&(te.muiSupportAuto=!0);const he=m.createContext({});function pt(e){return Q("MuiAccordion",e)}const O=K("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),ut=e=>{const{classes:t,square:o,expanded:n,disabled:r,disableGutters:d}=e;return Y({root:["root",!o&&"rounded",n&&"expanded",r&&"disabled",!d&&"gutters"],heading:["heading"],region:["region"]},pt,t)},mt=A(Pe,{name:"MuiAccordion",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[{[`& .${O.region}`]:t.region},t.root,!o.square&&t.rounded,!o.disableGutters&&t.gutters]}})(z(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{position:"relative",transition:e.transitions.create(["margin"],t),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(e.vars||e).palette.divider,transition:e.transitions.create(["opacity","background-color"],t)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${O.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${O.disabled}`]:{backgroundColor:(e.vars||e).palette.action.disabledBackground}}}),z(({theme:e})=>({variants:[{props:t=>!t.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(e.vars||e).shape.borderRadius,borderBottomRightRadius:(e.vars||e).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:t=>!t.disableGutters,style:{[`&.${O.expanded}`]:{margin:"16px 0"}}}]}))),xt=A("h3",{name:"MuiAccordion",slot:"Heading",overridesResolver:(e,t)=>t.heading})({all:"unset"}),gt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordion"}),{children:r,className:d,defaultExpanded:i=!1,disabled:c=!1,disableGutters:l=!1,expanded:p,onChange:g,square:f=!1,slots:C={},slotProps:D={},TransitionComponent:h,TransitionProps:b,...S}=n,[u,w]=Ie({controlled:p,default:i,name:"Accordion",state:"expanded"}),j=m.useCallback(_=>{w(!u),g&&g(_,!u)},[u,g,w]),[T,...P]=m.Children.toArray(r),y=m.useMemo(()=>({expanded:u,disabled:c,disableGutters:l,toggle:j}),[u,c,l,j]),x={...n,square:f,disabled:c,disableGutters:l,expanded:u},I=ut(x),Z={transition:h,...C},E={transition:b,...D},B={slots:Z,slotProps:E},[$,M]=ae("heading",{elementType:xt,externalForwardedProps:B,className:I.heading,ownerState:x}),[k,N]=ae("transition",{elementType:te,externalForwardedProps:B,ownerState:x});return s.jsxs(mt,{className:V(I.root,d),ref:o,ownerState:x,square:f,...S,children:[s.jsx($,{...M,children:s.jsx(he.Provider,{value:y,children:T})}),s.jsx(k,{in:u,timeout:"auto",...N,children:s.jsx("div",{"aria-labelledby":T.props.id,id:T.props["aria-controls"],role:"region",className:I.region,children:P})})]})});function ft(e){return Q("MuiAccordionDetails",e)}K("MuiAccordionDetails",["root"]);const ht=e=>{const{classes:t}=e;return Y({root:["root"]},ft,t)},bt=A("div",{name:"MuiAccordionDetails",slot:"Root",overridesResolver:(e,t)=>t.root})(z(({theme:e})=>({padding:e.spacing(1,2,2)}))),jt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordionDetails"}),{className:r,...d}=n,i=n,c=ht(i);return s.jsx(bt,{className:V(c.root,r),ref:o,ownerState:i,...d})});function yt(e){return Q("MuiAccordionSummary",e)}const W=K("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),vt=e=>{const{classes:t,expanded:o,disabled:n,disableGutters:r}=e;return Y({root:["root",o&&"expanded",n&&"disabled",!r&&"gutters"],focusVisible:["focusVisible"],content:["content",o&&"expanded",!r&&"contentGutters"],expandIconWrapper:["expandIconWrapper",o&&"expanded"]},yt,t)},Ct=A(Me,{name:"MuiAccordionSummary",slot:"Root",overridesResolver:(e,t)=>t.root})(z(({theme:e})=>{const t={duration:e.transitions.duration.shortest};return{display:"flex",minHeight:48,padding:e.spacing(0,2),transition:e.transitions.create(["min-height","background-color"],t),[`&.${W.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${W.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`&:hover:not(.${W.disabled})`]:{cursor:"pointer"},variants:[{props:o=>!o.disableGutters,style:{[`&.${W.expanded}`]:{minHeight:64}}}]}})),Dt=A("div",{name:"MuiAccordionSummary",slot:"Content",overridesResolver:(e,t)=>t.content})(z(({theme:e})=>({display:"flex",flexGrow:1,margin:"12px 0",variants:[{props:t=>!t.disableGutters,style:{transition:e.transitions.create(["margin"],{duration:e.transitions.duration.shortest}),[`&.${W.expanded}`]:{margin:"20px 0"}}}]}))),St=A("div",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper",overridesResolver:(e,t)=>t.expandIconWrapper})(z(({theme:e})=>({display:"flex",color:(e.vars||e).palette.action.active,transform:"rotate(0deg)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),[`&.${W.expanded}`]:{transform:"rotate(180deg)"}}))),wt=m.forwardRef(function(t,o){const n=X({props:t,name:"MuiAccordionSummary"}),{children:r,className:d,expandIcon:i,focusVisibleClassName:c,onClick:l,...p}=n,{disabled:g=!1,disableGutters:f,expanded:C,toggle:D}=m.useContext(he),h=u=>{D&&D(u),l&&l(u)},b={...n,expanded:C,disabled:g,disableGutters:f},S=vt(b);return s.jsxs(Ct,{focusRipple:!1,disableRipple:!0,disabled:g,component:"div","aria-expanded":C,className:V(S.root,d),focusVisibleClassName:V(S.focusVisible,c),onClick:h,ref:o,ownerState:b,...p,children:[s.jsx(Dt,{className:S.content,ownerState:b,children:r}),i&&s.jsx(St,{className:S.expandIconWrapper,ownerState:b,children:i})]})}),Et=ke(s.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown"),Rt=oe(({projectId:e})=>{var n;const t=L.getById(e),o=L.getTeam(e);return t?s.jsxs(gt,{disableGutters:!0,sx:{border:"1px solid",borderColor:se.palette.white.dark},children:[s.jsx(wt,{expandIcon:s.jsx(Et,{}),sx:{fontSize:18},children:"Project information"}),s.jsx(jt,{children:s.jsxs(J,{spacing:2,sx:{alignItems:"flex-start"},children:[s.jsx(F,{children:t.description||"No description provided"}),s.jsx(Oe,{assignee:t==null?void 0:t.lead}),o!=null&&o.length?s.jsx(Je,{team:o,excludeId:(n=t.lead)==null?void 0:n.id}):s.jsx(F,{children:"Project team is empty"})]})})]}):s.jsx(F,{children:"Error"})}),ue=(e,t)=>{if(t)return t.filter(o=>o.status===e)},At=e=>{if(e)return{transform:`translate(${e.x}px, ${e.y}px)`,zIndex:20,cursor:"grabbing"}},Tt=({data:e,draggable:t})=>{const o=ze(se.breakpoints.up("lg"))&&t,[n,r]=m.useState(o),{id:d}=e,{attributes:i,listeners:c,setNodeRef:l,transform:p}=Ye({id:d,disabled:!n}),g=At(p),f=D=>{D.stopPropagation(),r(!1)},C=()=>r(!0);return s.jsx(Ze,{data:e,ref:l,...c,...i,sx:{cursor:n?"grab":"default",...g},editBtn:s.jsx(Ke,{id:e.id,name:e.name,onPointerDown:f,onEditorClose:C}),deleteBtn:s.jsx(Qe,{id:e.id,name:e.name,onPointerDown:f})})},Pt=oe(({projectId:e})=>{const t=le.getByProjectId(e),o=n=>{const{active:r,over:d}=n;if(!d)return;const i=r.id,c=d.id,l=t.map(p=>i===p.id?{...p,status:c}:p);return le.update(l.find(p=>p.id===i)),l};return s.jsx(ie,{container:!0,spacing:2,size:"grow",sx:{[se.breakpoints.down("lg")]:{flexDirection:"column"}},children:s.jsx(_e,{onDragEnd:o,children:Xe.map(n=>{var r,d;return s.jsx(ie,{size:"grow",sx:{height:"100%",flexGrow:1},children:s.jsx(et,{label:n.label,tasksLength:((r=ue(n.id,t))==null?void 0:r.length)||0,column:n,children:(d=ue(n.id,t))==null?void 0:d.map(i=>s.jsx(Tt,{data:i,draggable:!0},i.id))})},n.id)})})})}),me=e=>e.split(".").reverse().join("-"),It=({projectId:e,setEditedProject:t})=>{var u,w,j,T;const[o,n]=m.useState(!1),r=L.getById(e);if(!r)return s.jsx(F,{children:"Error"});const d=tt({defaultValues:{name:r.name,description:r.description,lead:((u=r.lead)==null?void 0:u.id)||de.Unspecified,startDate:me(r.startDate),endDate:me(r.endDate)}}),{register:i,handleSubmit:c,getValues:l,setError:p,clearErrors:g,formState:f,reset:C,control:D}=d,{errors:h}=f,b=ce.get(),S=()=>{const P=l("startDate"),y=l("endDate"),x={name:l("name"),description:l("description"),lead:l("lead"),startDate:P,endDate:y};if(new Date(P)>new Date(y)){p("endDate",{type:"validate",message:"End date cannot be earlier than start date."});return}g("endDate");const I={...r,...x,lead:ce.getById(x.lead)};n(!0),t(I),C(x)};return s.jsx("form",{onSubmit:c(S),noValidate:!0,children:s.jsxs(J,{spacing:2,children:[s.jsx(q,{id:"project-name",label:"Name",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",error:!!h.name,helperText:(w=h.name)==null?void 0:w.message,...i("name",{required:"Name is required."})}),s.jsx(q,{id:"project-description",label:"Description",variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",multiline:!0,minRows:3,maxRows:3,...i("description")}),s.jsx(st,{control:D,name:"lead",render:({field:P})=>s.jsxs(ot,{fullWidth:!0,children:[s.jsx(nt,{id:"project-lead-label",children:"Lead"}),s.jsxs(rt,{id:"project-lead",labelId:"project-lead-label",label:"Lead",...P,sx:{alignSelf:"flex-start",width:"100%"},children:[s.jsx(pe,{value:de.Unspecified,selected:!0,children:"Unspecified"}),!!(b!=null&&b.data.length)&&b.data.map(y=>s.jsx(pe,{value:y.id,children:y.name},y.id))]})]})}),s.jsx(q,{id:"project-start-date",label:"Start date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",type:"date",error:!!h.startDate,helperText:(j=h.startDate)==null?void 0:j.message,...i("startDate",{required:"Start date is required."})}),s.jsx(q,{id:"project-end-date",label:"End date",slotProps:{inputLabel:{shrink:!0}},variant:"filled",sx:{alignSelf:"flex-start",width:"100%"},size:"small",type:"date",error:!!h.endDate,helperText:(T=h.endDate)==null?void 0:T.message,...i("endDate",{required:"End date is required."})}),s.jsxs(J,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[s.jsx(xe,{variant:"contained",disabled:!f.isDirty,type:"submit",children:"Save"}),o&&s.jsx(F,{color:"success",children:"Changes saved."})]})]})})},Mt=({id:e,name:t,onEditorClose:o,onPointerDown:n})=>{const[r,d]=m.useState(null),i=()=>{r&&L.update(r),o&&o()},{openModal:c,handleModalOpen:l,handleModalClose:p}=Be(!1,i);return s.jsxs(s.Fragment,{children:[s.jsx(ge,{title:"Edit",children:s.jsx(fe,{size:"small",onPointerDown:n,onClick:l,children:s.jsx(Ue,{})})}),s.jsx($e,{title:`Edit project '${t}'`,open:c,onClose:p,children:s.jsx(It,{projectId:e,setEditedProject:d})})]})},kt=({id:e,name:t,redirectOnDelete:o})=>{const{dialog:n,handleDeleteClick:r}=Ve(()=>L.delete(e),o);return s.jsxs(s.Fragment,{children:[s.jsx(ge,{title:"Delete",children:s.jsx(fe,{size:"small",onClick:n.handleModalOpen,children:s.jsx(He,{})})}),s.jsx(qe,{title:`Are you sure you want to delete project '${t}'?`,open:n.openModal,onClose:n.handleModalClose,actionButtons:s.jsx(xe,{color:"sensitive",variant:"contained",onClick:r,children:"Delete"})})]})},Jt=oe(({})=>{const{projectId:e}=Ne(),t=L.getById(e);return!t||!e?s.jsx(F,{children:"Error"}):s.jsxs(J,{spacing:1,sx:{height:"100%"},children:[s.jsxs(Le,{title:t.name,children:[s.jsx(Ge,{to:"create-task",variant:"contained",children:"Add task"}),s.jsx(Mt,{id:e,name:t.name}),s.jsx(kt,{id:e,name:t.name,redirectOnDelete:We("",Fe.Projects)})]}),s.jsx(Rt,{projectId:e}),s.jsx(Pt,{projectId:e})]})});export{Jt as default};
