import{j as e,l as g,M as P,d as f,g as u,r as b,T as r,S as h,i as C,k as w,e as y,U as B,t as S,P as E,V as M,B as D,R as k}from"./index-BKcszQKM.js";import{u as R,T as F,a as I,b as O,c as m,d as l,e as V,f as z}from"./useTablePagination-DFcPhFhq.js";import{u as H,D as A,B as N,E as Y,o as $}from"./Delete-DroR5Y-1.js";import{u as q}from"./index.esm-C2g7lyzA.js";import{T as G}from"./TextField-BVlZHFqG.js";import"./Select-Ds_JSibu.js";import"./utils-ishblJic.js";import"./MenuItem-D_-LpAxY.js";const L=({id:s,name:n,redirectOnDelete:t})=>{const{dialog:o,handleDeleteClick:a}=H(()=>u.delete(s),t);return e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Delete",children:e.jsx(P,{size:"small",onClick:o.handleModalOpen,children:e.jsx(A,{})})}),e.jsx(N,{title:`Are you sure you want to delete position '${n}'?`,open:o.openModal,onClose:o.handleModalClose,actionButtons:e.jsx(f,{color:"sensitive",variant:"contained",onClick:a,children:"Delete"})})]})},U=({positionId:s,setEditedPosition:n})=>{const[t,o]=b.useState(!1);if(!s)return e.jsx(r,{children:"Error"});const a=u.getById(s);if(!a)return e.jsx(r,{children:"Error"});const d=q({defaultValues:{name:a.name}}),{register:c,handleSubmit:i,formState:x,reset:j,getValues:T}=d,v=()=>{const p={...a,name:T("name")};o(!0),n(p),j(p)};return e.jsx("form",{onSubmit:i(v),noValidate:!0,children:e.jsxs(h,{spacing:2,children:[e.jsx(G,{id:"position-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...c("name",{required:!0})}),e.jsxs(h,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(f,{variant:"contained",disabled:!x.isDirty,type:"submit",children:"Save"}),t&&e.jsx(r,{color:"success",children:"Changes saved."})]})]})})},J=({id:s,name:n,onEditorClose:t,onPointerDown:o})=>{const[a,d]=b.useState(null),c=()=>{a&&u.update(a),t&&t()},{openModal:i,handleModalOpen:x,handleModalClose:j}=C(!1,c);return e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Edit",children:e.jsx(P,{size:"small",onPointerDown:o,onClick:x,children:e.jsx(Y,{})})}),e.jsx(w,{title:`Edit position '${n}'`,open:i,onClose:j,children:e.jsx(U,{positionId:s,setEditedPosition:d})})]})},K=(s,n)=>s?s.filter(t=>{var o;return((o=t.position)==null?void 0:o.id)===n}).length:0,Q=$(({})=>{const s=u.get(),n=y.get();if(!s||!s.length)return e.jsx(r,{children:"You haven't added any positions yet"});const{page:t,rowsPerPage:o,visibleRows:a,handleChangePage:d,handleChangeRowsPerPage:c}=R(s,12);return e.jsxs(h,{component:B,elevation:3,sx:{flexGrow:1,justifyContent:"space-between",overflow:"hidden"},children:[e.jsx(F,{children:e.jsxs(I,{children:[e.jsx(O,{sx:{bgcolor:S.palette.white.dark},children:e.jsxs(m,{children:[e.jsx(l,{sx:{py:1},children:"Position"}),e.jsx(l,{sx:{py:1},align:"right",children:"Executors"}),e.jsx(l,{sx:{width:"10px",p:.5}}),e.jsx(l,{sx:{width:"10px",p:.5}})]})}),e.jsx(V,{children:a.map((i,x)=>e.jsxs(m,{hover:!0,children:[e.jsx(l,{children:i.name}),e.jsx(l,{align:"right",children:K(n==null?void 0:n.data,i.id)}),e.jsx(l,{sx:{width:"10px",p:.5},children:e.jsx(J,{id:i.id,name:i.name})}),e.jsx(l,{sx:{width:"10px",p:.5},children:e.jsx(L,{id:i.id,name:i.name})})]},i.name+x))})]})}),e.jsx(z,{rowsPerPageOptions:[12,25],component:"div",count:s.length,rowsPerPage:o,page:t,onPageChange:d,onRowsPerPageChange:c})]})}),W=({open:s,onClose:n})=>e.jsx(w,{title:"Tutorial",open:s,onClose:n,children:e.jsxs(h,{spacing:1,sx:{pl:.5},children:[e.jsx(r,{children:"You can see all positions on this page."}),e.jsx(r,{children:"Position can be assigned to executor"})]})}),{Create:X}=k,Z=({})=>{const{openModal:s,handleModalOpen:n,handleModalClose:t}=C(!1);return e.jsxs(E,{title:"Positions",children:[e.jsx(M,{onClick:n}),e.jsx(W,{open:s,onClose:t}),e.jsx(D,{variant:"contained",to:X,children:"New"})]})},le=()=>e.jsxs(h,{sx:{height:"100%"},children:[e.jsx(Z,{}),e.jsx(Q,{})]});export{le as default};
