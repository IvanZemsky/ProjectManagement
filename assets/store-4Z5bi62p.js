import{e as d,c as u,v as f,b as j,m as g,A as l}from"./index-C-jB6FNB.js";import{t as m}from"./store-D9YZTOGP.js";const h=c=>{const t=new Date(c),a=t.getFullYear(),e=t.getMonth()+1,s=t.getDate(),r=s<10?`0${s}`:s,n=e<10?`0${e}`:e;return`${r}.${n}.${a}`};class v{constructor(){this.projects=[],this.isInitialized=!1,this.get=(t,a)=>{const e=this.projects.length;if(t===void 0||a===void 0)return{data:this.projects,totalCount:e};const s=(a-1)*t;return{data:this.projects.slice(s,s+t),totalCount:e}},this.getById=t=>this.projects.find(a=>a.id===t)||null,this.getTeam=t=>{const a=m.getByProjectId(t),e=d.get();if(!e)return null;const s=a.flatMap(o=>o.team),r=a.map(o=>{var i;return(i=o.assignee)==null?void 0:i.id}).filter(o=>o!==void 0),n=[...s,...r];return e.data.filter(o=>n.some(i=>o.id===i))},this.getAllWithLead=(t,a,e)=>{const s=this.projects.filter(o=>{var i;return((i=o.lead)==null?void 0:i.id)===t}),r=s.length;if(e===void 0||a===void 0)return{data:s,totalCount:r};const n=(a-1)*e;return{data:s.slice(n,n+e),totalCount:r}},this.create=t=>{const e=t.leadId===u.Unspecified?null:d.getById(t.leadId),s={id:f(),name:t.name,description:t.description,lead:e,startDate:h(t.startDate),endDate:h(t.endDate)};return this.projects.push(s),s},this.autosaveState=()=>{j(()=>{this.isInitialized&&l.set("projects",this.projects)})},g(this),this.loadProjects(),this.autosaveState()}loadProjects(){this.projects=l.get("projects")||[],this.isInitialized=!0}}const S=new v;export{S as p};
