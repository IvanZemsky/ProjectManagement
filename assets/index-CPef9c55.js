import{r as u,j as e,T as i,S as r,I as P,J as v,H as y,F as E,o as w,n as F,K as A,O as V,M as W,R as L}from"./index-DW7niEK_.js";import{p as O,t as U,e as m,a as S}from"./store-DDDbk47J.js";import{P as z}from"./PageHeader-BcXiUKO0.js";import{u as G,D as R,B as $,E as H,o as q}from"./Delete-CcYEeSlv.js";import{P as J}from"./ProjectCard-n_8z5CE3.js";import{A as B,P as k}from"./AutoGrid-BTHqS-sk.js";import{T as K}from"./TaskColumn-Cf5tcA9W.js";import{u as N,C as Q,F as X}from"./index.esm-BZsw8hz4.js";import{T as Y,I as Z}from"./TextField-D9CnMREb.js";import{S as _}from"./Select-DnoR1PEi.js";import{M as C}from"./MenuItem-3KFYzs4i.js";import"./CardContent-DhbWX8Eh.js";import"./utils-C_uqNxTM.js";const I=5,ee=({executorId:s})=>{const[t,a]=u.useState(1),n=O.getAllWithLead(s,t,I);return n.data.length?e.jsxs(r,{spacing:1,children:[e.jsx(i,{variant:"h3",children:"Appointed to projects"}),e.jsxs(r,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(B,{minItemWidth:"270px",spacing:2,children:n.data.map(o=>e.jsx(J,{data:o},o.id))}),e.jsx(k,{currentPage:t,setPage:a,itemsCount:n.totalCount,limit:I})]})]}):e.jsx(i,{children:"This executor has not yet been appointed project lead"})},b=5,te=({executorId:s})=>{const[t,a]=u.useState(1),n=U.getAllWithExecutor(s,t,b);return n.data.length?e.jsxs(r,{spacing:1,children:[e.jsx(i,{variant:"h3",children:"Assigned to tasks"}),e.jsxs(r,{spacing:2,sx:{flexGrow:1,justifyContent:"space-between"},children:[e.jsx(B,{minItemWidth:"270px",spacing:2,children:n.data.map(o=>e.jsx(K,{data:o},o.id))}),e.jsx(k,{currentPage:t,setPage:a,itemsCount:n.totalCount,limit:b})]})]}):e.jsx(i,{children:"This executor has not yet been assigned to tasks"})},se=({id:s,name:t,redirectOnDelete:a})=>{const{dialog:n,handleDeleteClick:o}=G(()=>m.delete(s),a);return e.jsxs(e.Fragment,{children:[e.jsx(P,{title:"Delete",children:e.jsx(v,{size:"small",onClick:n.handleModalOpen,children:e.jsx(R,{})})}),e.jsx($,{title:`Are you sure you want to delete executor '${t}'?`,open:n.openModal,onClose:n.handleModalClose,actionButtons:e.jsx(y,{color:"sensitive",variant:"contained",onClick:o,children:"Delete"})})]})},ne=({executorId:s,setEditedExecutor:t})=>{var f;const[a,n]=u.useState(!1),o=m.getById(s);if(!o)return e.jsx(i,{children:"Error"});const p=N({defaultValues:{name:o.name,position:((f=o.position)==null?void 0:f.id)||E.Unspecified}}),{register:h,handleSubmit:j,getValues:d,control:g,formState:D,reset:M}=p,x=S.get(),T=()=>{const l={name:d("name").trim(),position:d("position")},c={...o,name:l.name,position:S.getById(l.position)};n(!0),t(c),M(l)};return e.jsx("form",{onSubmit:j(T),noValidate:!0,children:e.jsxs(r,{spacing:2,children:[e.jsx(Y,{id:"executor-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...h("name",{required:!0})}),e.jsx(Q,{control:g,name:"position",render:({field:l})=>e.jsxs(X,{fullWidth:!0,children:[e.jsx(Z,{id:"position-label",children:"Position"}),e.jsxs(_,{id:"position",labelId:"position-label",label:"Position",...l,sx:{alignSelf:"flex-start",width:"100%"},children:[e.jsx(C,{value:E.Unspecified,children:"Unspecified"}),!!(x!=null&&x.length)&&x.map(c=>e.jsx(C,{value:c.id,children:c.name},c.name))]})]})}),e.jsxs(r,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(y,{variant:"contained",disabled:!D.isDirty,type:"submit",children:"Save"}),a&&e.jsx(i,{color:"success",children:"Changes saved."})]})]})})},oe=({id:s,name:t,onEditorClose:a,onPointerDown:n})=>{const[o,p]=u.useState(null),h=()=>{o&&m.update(o),a&&a()},{openModal:j,handleModalOpen:d,handleModalClose:g}=w(!1,h);return e.jsxs(e.Fragment,{children:[e.jsx(P,{title:"Edit",children:e.jsx(v,{size:"small",onPointerDown:n,onClick:d,children:e.jsx(H,{})})}),e.jsx(F,{title:`Edit task '${t}'`,open:j,onClose:g,children:e.jsx(ne,{executorId:s,setEditedExecutor:p})})]})},fe=q(()=>{var a;const{executorId:s}=A(),t=m.getById(s);return!s||!t?e.jsx(i,{children:"Error"}):e.jsxs(r,{spacing:2,children:[e.jsxs(V,{children:[e.jsxs(z,{title:t.name,children:[e.jsx(oe,{id:s,name:t.name}),e.jsx(se,{id:s,name:t.name,redirectOnDelete:W("",L.Executors)})]}),e.jsx(i,{children:((a=t.position)==null?void 0:a.name)||"Unspecified position"})]}),e.jsxs(r,{spacing:3,children:[e.jsx(te,{executorId:s}),e.jsx(ee,{executorId:s})]})]})});export{fe as default};
