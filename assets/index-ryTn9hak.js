import{j as e,I as g,J as P,H as f,r as b,T as l,S as h,o as C,n as w,P as y,t as B,p as S,B as E,R as M}from"./index-DW7niEK_.js";import{u as D,a as k,b as I,c as R,d as m,T as r,e as F,f as H}from"./TableRow-BDFXj6a3.js";import{a as u,e as O}from"./store-DDDbk47J.js";import{u as z,D as V,B as A,E as N,o as Y}from"./Delete-CcYEeSlv.js";import{u as $}from"./index.esm-BZsw8hz4.js";import{T as q}from"./TextField-D9CnMREb.js";import{P as G}from"./PageHeader-BcXiUKO0.js";import"./Select-DnoR1PEi.js";import"./utils-C_uqNxTM.js";import"./MenuItem-3KFYzs4i.js";const J=({id:s,name:n,redirectOnDelete:t})=>{const{dialog:o,handleDeleteClick:a}=z(()=>u.delete(s),t);return e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Delete",children:e.jsx(P,{size:"small",onClick:o.handleModalOpen,children:e.jsx(V,{})})}),e.jsx(A,{title:`Are you sure you want to delete position '${n}'?`,open:o.openModal,onClose:o.handleModalClose,actionButtons:e.jsx(f,{color:"sensitive",variant:"contained",onClick:a,children:"Delete"})})]})},L=({positionId:s,setEditedPosition:n})=>{const[t,o]=b.useState(!1);if(!s)return e.jsx(l,{children:"Error"});const a=u.getById(s);if(!a)return e.jsx(l,{children:"Error"});const d=$({defaultValues:{name:a.name}}),{register:c,handleSubmit:i,formState:x,reset:j,getValues:T}=d,v=()=>{const p={...a,name:T("name")};o(!0),n(p),j(p)};return e.jsx("form",{onSubmit:i(v),noValidate:!0,children:e.jsxs(h,{spacing:2,children:[e.jsx(q,{id:"position-name",label:"Name",variant:"filled",autoFocus:!0,sx:{alignSelf:"flex-start",width:"100%"},size:"small",...c("name",{required:!0})}),e.jsxs(h,{direction:"row",spacing:2,sx:{alignItems:"center"},children:[e.jsx(f,{variant:"contained",disabled:!x.isDirty,type:"submit",children:"Save"}),t&&e.jsx(l,{color:"success",children:"Changes saved."})]})]})})},K=({id:s,name:n,onEditorClose:t,onPointerDown:o})=>{const[a,d]=b.useState(null),c=()=>{a&&u.update(a),t&&t()},{openModal:i,handleModalOpen:x,handleModalClose:j}=C(!1,c);return e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Edit",children:e.jsx(P,{size:"small",onPointerDown:o,onClick:x,children:e.jsx(N,{})})}),e.jsx(w,{title:`Edit position '${n}'`,open:i,onClose:j,children:e.jsx(L,{positionId:s,setEditedPosition:d})})]})},Q=(s,n)=>s?s.filter(t=>{var o;return((o=t.position)==null?void 0:o.id)===n}).length:0,U=Y(({})=>{const s=u.get(),n=O.get(),{page:t,rowsPerPage:o,visibleRows:a,handleChangePage:d,handleChangeRowsPerPage:c}=D(s,12);return!s||!s.length?e.jsx(l,{children:"You haven't added any positions yet"}):e.jsxs(h,{component:y,elevation:3,sx:{flexGrow:1,justifyContent:"space-between",overflow:"hidden"},children:[e.jsx(k,{children:e.jsxs(I,{children:[e.jsx(R,{sx:{bgcolor:B.palette.white.dark},children:e.jsxs(m,{children:[e.jsx(r,{sx:{py:1},children:"Position"}),e.jsx(r,{sx:{py:1},align:"right",children:"Executors"}),e.jsx(r,{sx:{width:"10px",p:.5}}),e.jsx(r,{sx:{width:"10px",p:.5}})]})}),e.jsx(F,{children:a.map((i,x)=>e.jsxs(m,{hover:!0,children:[e.jsx(r,{children:i.name}),e.jsx(r,{align:"right",children:Q(n==null?void 0:n.data,i.id)}),e.jsx(r,{sx:{width:"10px",p:.5},children:e.jsx(K,{id:i.id,name:i.name})}),e.jsx(r,{sx:{width:"10px",p:.5},children:e.jsx(J,{id:i.id,name:i.name})})]},i.name+x))})]})}),e.jsx(H,{rowsPerPageOptions:[12,25],component:"div",count:s.length,rowsPerPage:o,page:t,onPageChange:d,onRowsPerPageChange:c})]})}),W=({open:s,onClose:n})=>e.jsx(w,{title:"Tutorial",open:s,onClose:n,children:e.jsxs(h,{spacing:1,sx:{pl:.5},children:[e.jsx(l,{children:"You can see all positions on this page."}),e.jsx(l,{children:"Position can be assigned to executor"})]})}),{Create:X}=M,Z=({})=>{const{openModal:s,handleModalOpen:n,handleModalClose:t}=C(!1);return e.jsxs(G,{title:"Positions",children:[e.jsx(S,{onClick:n}),e.jsx(W,{open:s,onClose:t}),e.jsx(E,{variant:"contained",to:X,children:"New"})]})},de=()=>e.jsxs(h,{sx:{height:"100%"},children:[e.jsx(Z,{}),e.jsx(U,{})]});export{de as default};
